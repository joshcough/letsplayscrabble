// Generated by purs version 0.15.15
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
import * as Data_Tuple from "../Data.Tuple/index.js";
import * as Foreign_Object from "../Foreign.Object/index.js";
import * as Web_HTML from "../Web.HTML/index.js";
import * as Web_HTML_Location from "../Web.HTML.Location/index.js";
import * as Web_HTML_Window from "../Web.HTML.Window/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var fromFoldable = /* #__PURE__ */ Foreign_Object.fromFoldable(Data_Foldable.foldableArray);
var bind1 = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var parseQueryString = function (str) {
    var withoutQuestion = (function () {
        var v = Data_String_Common.split("?")(str);
        if (v.length === 2) {
            return v[1];
        };
        if (v.length === 1) {
            return v[0];
        };
        return "";
    })();
    var parsePair = function (pair) {
        var v = Data_String_Common.split("=")(pair);
        if (v.length === 2) {
            return new Data_Maybe.Just({
                key: v[0],
                value: v[1]
            });
        };
        return Data_Maybe.Nothing.value;
    };
    var pairs = Data_String_Common.split("&")(withoutQuestion);
    var kvPairs = map(function (v) {
        return new Data_Tuple.Tuple(v.key, v.value);
    })(Data_Array.catMaybes(map(parsePair)(pairs)));
    return fromFoldable(kvPairs);
};
var getQueryString = function __do() {
    var win = Web_HTML.window();
    var loc = Web_HTML_Window.location(win)();
    return Web_HTML_Location.search(loc)();
};
var getParam = function (key) {
    return function (params) {
        return Foreign_Object.lookup(key)(params);
    };
};
var getParamInt = function (key) {
    return function (params) {
        return bind1(getParam(key)(params))(function (value) {
            return Data_Int.fromString(value);
        });
    };
};
var parseUrlParams = function __do() {
    var queryStr = getQueryString();
    var params = parseQueryString(queryStr);
    return {
        userId: getParamInt("userId")(params),
        tournamentId: getParamInt("tournamentId")(params),
        divisionId: getParamInt("divisionId")(params),
        divisionName: getParam("divisionName")(params)
    };
};
export {
    getQueryString,
    parseQueryString,
    getParam,
    getParamInt,
    parseUrlParams
};
