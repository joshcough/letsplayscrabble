// Generated by purs version 0.15.15
import * as Backend_MonadBackend from "../Backend.MonadBackend/index.js";
import * as CSS_Class from "../CSS.Class/index.js";
import * as CSS_ThemeColor from "../CSS.ThemeColor/index.js";
import * as Config_Themes from "../Config.Themes/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as DOM_HTML_Indexed_ButtonType from "../DOM.HTML.Indexed.ButtonType/index.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Utils_CSS from "../Utils.CSS/index.js";
import * as Utils_Halogen from "../Utils.Halogen/index.js";
import * as Web_Event_Event from "../Web.Event.Event/index.js";
var type_ = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType);
var value = /* #__PURE__ */ Halogen_HTML_Properties.value(Halogen_HTML_Core.isPropString);
var type_1 = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropButtonType);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM);
var bind = /* #__PURE__ */ Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM);
var get = /* #__PURE__ */ Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM);
var pure = /* #__PURE__ */ Control_Applicative.pure(Halogen_Query_HalogenM.applicativeHalogenM);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var UpdateUsername = /* #__PURE__ */ (function () {
    function UpdateUsername(value0) {
        this.value0 = value0;
    };
    UpdateUsername.create = function (value0) {
        return new UpdateUsername(value0);
    };
    return UpdateUsername;
})();
var UpdatePassword = /* #__PURE__ */ (function () {
    function UpdatePassword(value0) {
        this.value0 = value0;
    };
    UpdatePassword.create = function (value0) {
        return new UpdatePassword(value0);
    };
    return UpdatePassword;
})();
var HandleSubmit = /* #__PURE__ */ (function () {
    function HandleSubmit(value0) {
        this.value0 = value0;
    };
    HandleSubmit.create = function (value0) {
        return new HandleSubmit(value0);
    };
    return HandleSubmit;
})();
var render = function (state) {
    return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.PageBackground.value), Utils_CSS.cls(CSS_Class.CenterContainer.value), Utils_CSS.cls(CSS_Class.P_6.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.MaxW_Md.value), Utils_CSS.cls(CSS_Class.W_Full.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.Mb_8.value) ]) ])([ Halogen_HTML_Elements.h1([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Text_5xl.value), Utils_CSS.cls(CSS_Class.FontBlack.value), Utils_CSS.cls(CSS_Class.Mb_2.value), Utils_CSS.raw(state.theme.titleExtraClasses), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TitleGradient.value) ]) ])([ Halogen_HTML_Core.text("Let's Play Scrabble") ]), Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Text_Lg.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextSecondary.value) ]) ])([ Halogen_HTML_Core.text("Sign in to manage your tournaments") ]) ]), Halogen_HTML_Elements.form([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.Rounded_2xl.value), Utils_CSS.cls(CSS_Class.P_8.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.cls(CSS_Class.Shadow_2xl.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.ShadowColor.value) ]), Halogen_HTML_Events.onSubmit(HandleSubmit.create) ])([ (function () {
        if (state.error instanceof Data_Maybe.Just) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mb_6.value), Utils_CSS.cls(CSS_Class.P_4.value), Utils_CSS.raw("bg-red-900/50"), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.raw("border-red-400/50"), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.TextRed200.value), Utils_CSS.cls(CSS_Class.Text_Sm.value) ]) ])([ Halogen_HTML_Core.text(state.error.value0) ]);
        };
        if (state.error instanceof Data_Maybe.Nothing) {
            return Halogen_HTML_Core.text("");
        };
        throw new Error("Failed pattern match at Component.LoginPage (line 88, column 17 - line 93, column 40): " + [ state.error.constructor.name ]);
    })(), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mb_6.value) ]) ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]), Halogen_HTML_Properties["for"]("username") ])([ Halogen_HTML_Core.text("Username") ]), Halogen_HTML_Elements.input([ type_(DOM_HTML_Indexed_InputType.InputText.value), Halogen_HTML_Properties.id("username"), value(state.username), Halogen_HTML_Events.onValueInput(UpdateUsername.create), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.raw("bg-black/20"), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FocusOutlineNone.value), Utils_CSS.cls(CSS_Class.FocusBorderAmber_400.value), Utils_CSS.cls(CSS_Class.TransitionColors.value) ]), Halogen_HTML_Properties.placeholder("Enter your username"), Halogen_HTML_Properties.required(true), Halogen_HTML_Properties.disabled(state.loading) ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mb_6.value) ]) ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]), Halogen_HTML_Properties["for"]("password") ])([ Halogen_HTML_Core.text("Password") ]), Halogen_HTML_Elements.input([ type_(DOM_HTML_Indexed_InputType.InputPassword.value), Halogen_HTML_Properties.id("password"), value(state.password), Halogen_HTML_Events.onValueInput(UpdatePassword.create), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.raw("bg-black/20"), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FocusOutlineNone.value), Utils_CSS.cls(CSS_Class.FocusBorderAmber_400.value), Utils_CSS.cls(CSS_Class.TransitionColors.value) ]), Halogen_HTML_Properties.placeholder("Enter your password"), Halogen_HTML_Properties.required(true), Halogen_HTML_Properties.disabled(state.loading) ]) ]), Halogen_HTML_Elements.button([ type_1(DOM_HTML_Indexed_ButtonType.ButtonSubmit.value), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.cls(CSS_Class.Text_Lg.value), Utils_CSS.cls(CSS_Class.TransitionAll.value), Utils_CSS.raw((function () {
        if (state.loading) {
            return "bg-gray-600 text-gray-400 cursor-not-allowed";
        };
        return "bg-gradient-to-r from-amber-500 to-orange-500 text-white hover:from-amber-600 hover:to-orange-600 cursor-pointer";
    })()) ]), Halogen_HTML_Properties.disabled(state.loading) ])([ Halogen_HTML_Core.text((function () {
        if (state.loading) {
            return "Signing in...";
        };
        return "Sign In";
    })()) ]) ]) ]) ]);
};
var initialState = function (v) {
    return {
        username: "",
        password: "",
        error: Data_Maybe.Nothing.value,
        loading: false,
        theme: Config_Themes.getTheme("scrabble")
    };
};
var handleSubmit = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var login = Backend_MonadBackend.login(dictMonadBackend);
    return function (dictMonadEffect) {
        var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadEffect));
        return function (event) {
            return discard(liftEffect(Web_Event_Event.preventDefault(event)))(function () {
                return bind(get)(function (state) {
                    return withLoading(login({
                        username: state.username,
                        password: state.password
                    }))(function (res) {
                        return Halogen_Query_HalogenM.raise({
                            token: res.token,
                            userId: res.userId,
                            username: res.username
                        });
                    });
                });
            });
        };
    };
};
var handleAction = function (dictMonadBackend) {
    var handleSubmit1 = handleSubmit(dictMonadBackend);
    return function (dictMonadEffect) {
        var handleSubmit2 = handleSubmit1(dictMonadEffect);
        return function (v) {
            if (v instanceof Initialize) {
                return pure(Data_Unit.unit);
            };
            if (v instanceof UpdateUsername) {
                return modify_(function (v1) {
                    var $35 = {};
                    for (var $36 in v1) {
                        if ({}.hasOwnProperty.call(v1, $36)) {
                            $35[$36] = v1[$36];
                        };
                    };
                    $35.username = v.value0;
                    $35.error = Data_Maybe.Nothing.value;
                    return $35;
                });
            };
            if (v instanceof UpdatePassword) {
                return modify_(function (v1) {
                    var $39 = {};
                    for (var $40 in v1) {
                        if ({}.hasOwnProperty.call(v1, $40)) {
                            $39[$40] = v1[$40];
                        };
                    };
                    $39.password = v.value0;
                    $39.error = Data_Maybe.Nothing.value;
                    return $39;
                });
            };
            if (v instanceof HandleSubmit) {
                return handleSubmit2(v.value0);
            };
            throw new Error("Failed pattern match at Component.LoginPage (line 147, column 16 - line 157, column 23): " + [ v.constructor.name ]);
        };
    };
};
var component = function (dictMonadBackend) {
    var handleAction1 = handleAction(dictMonadBackend);
    return function (dictMonadEffect) {
        return Halogen_Component.mkComponent({
            initialState: initialState,
            render: render,
            "eval": Halogen_Component.mkEval({
                handleQuery: Halogen_Component.defaultEval.handleQuery,
                receive: Halogen_Component.defaultEval.receive,
                finalize: Halogen_Component.defaultEval.finalize,
                handleAction: handleAction1(dictMonadEffect),
                initialize: new Data_Maybe.Just(Initialize.value)
            })
        });
    };
};
export {
    Initialize,
    UpdateUsername,
    UpdatePassword,
    HandleSubmit,
    component,
    initialState,
    render,
    handleAction,
    handleSubmit
};
