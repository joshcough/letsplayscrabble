// Generated by purs version 0.15.15
import * as BroadcastChannel from "../BroadcastChannel/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Effect from "../Effect/index.js";
import * as Foreign from "../Foreign/index.js";
import * as Halogen_Subscription from "../Halogen.Subscription/index.js";
import * as PubSub_Class from "../PubSub.Class/index.js";
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect.applicativeEffect);
var BroadcastChannelPubSub = function (x) {
    return x;
};
var pubSubBroadcastChannelPub = {
    create: function (name) {
        return function __do() {
            var channel = BroadcastChannel.create(name)();
            return channel;
        };
    },
    postMessage: function (v) {
        return function (message) {
            return BroadcastChannel.postMessage(v)(Foreign.unsafeToForeign(message));
        };
    },
    subscribe: function (v) {
        return pure(Halogen_Subscription.makeEmitter(function (push) {
            return function __do() {
                BroadcastChannel.onMessage(v)(function (foreignVal) {
                    var json = Foreign.unsafeFromForeign(foreignVal);
                    return push(json);
                })();
                return pure(Data_Unit.unit);
            };
        }));
    },
    close: function (v) {
        return BroadcastChannel.close(v);
    }
};
var productionChannel = /* #__PURE__ */ PubSub_Class.create(pubSubBroadcastChannelPub);
export {
    BroadcastChannelPubSub,
    productionChannel,
    pubSubBroadcastChannelPub
};
