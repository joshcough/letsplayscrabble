// Generated by purs version 0.15.15
import * as CSS_Class from "../CSS.Class/index.js";
import * as CSS_ThemeColor from "../CSS.ThemeColor/index.js";
import * as Component_Overlay_BaseOverlay from "../Component.Overlay.BaseOverlay/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Newtype from "../Data.Newtype/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Stats_HeadToHeadGameLogic from "../Stats.HeadToHeadGameLogic/index.js";
import * as Stats_HeadToHeadStats from "../Stats.HeadToHeadStats/index.js";
import * as Utils_CSS from "../Utils.CSS/index.js";
import * as Utils_Date from "../Utils.Date/index.js";
import * as Utils_Format from "../Utils.Format/index.js";
import * as Utils_PlayerImage from "../Utils.PlayerImage/index.js";
var map = /* #__PURE__ */ Data_Functor.map(Data_Maybe.functorMaybe);
var unwrap = /* #__PURE__ */ Data_Newtype.unwrap();
var map1 = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var renderGameRow = function (theme) {
    return function (p1) {
        return function (v) {
            return function (game) {
                var p1XtId = Data_Maybe.fromMaybe(0)(map(unwrap)(p1.xtid));
                var result = Stats_HeadToHeadGameLogic.calculateGameResult(p1XtId)(game);
                var locationRaw = Stats_HeadToHeadGameLogic.getTournamentLocation(game);
                var location = Utils_Format.abbreviateTournamentName(locationRaw);
                return Halogen_HTML_Elements.tr([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.BorderB.value), Utils_CSS.thm(theme)(CSS_ThemeColor.SecondaryBorder.value), Utils_CSS.raw("last:border-0"), Utils_CSS.thm(theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.TransitionColors.value) ]) ])([ Halogen_HTML_Elements.td([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Lg.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.cls(CSS_Class.TextLeft.value) ]) ])([ Halogen_HTML_Core.text(Utils_Date.toLocaleDateString(game.game.date)) ]), Halogen_HTML_Elements.td([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_2.value), Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.raw(result.p1Color), Utils_CSS.cls(CSS_Class.Text_Lg.value) ]) ])([ Halogen_HTML_Core.text(result.p1Result) ]), Halogen_HTML_Elements.td([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_2.value), Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FontMono.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.cls(CSS_Class.Text_Xl.value) ]) ])([ Halogen_HTML_Core.text(result.scores) ]), Halogen_HTML_Elements.td([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_2.value), Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.raw(result.p2Color), Utils_CSS.cls(CSS_Class.Text_Lg.value) ]) ])([ Halogen_HTML_Core.text(result.p2Result) ]), Halogen_HTML_Elements.td([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Lg.value), Utils_CSS.cls(CSS_Class.FontBold.value), Utils_CSS.cls(CSS_Class.TextRight.value) ]), Halogen_HTML_Properties.title(location) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.OverflowHidden.value), Utils_CSS.cls(CSS_Class.TextEllipsis.value), Utils_CSS.cls(CSS_Class.WhitespaceNowrap.value) ]) ])([ Halogen_HTML_Core.text(Utils_Format.abbreviateTournamentName(location)) ]) ]) ]);
            };
        };
    };
};
var renderGamesTable = function (theme) {
    return function (p1) {
        return function (p2) {
            return function (games) {
                return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mt_8.value), Utils_CSS.cls(CSS_Class.MaxW_6xl.value), Utils_CSS.cls(CSS_Class.Mx_Auto.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.JustifyCenter.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value) ]), Halogen_HTML_Properties.attr("style")("max-width: 56rem") ])([ Halogen_HTML_Elements.h3([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Base.value), Utils_CSS.cls(CSS_Class.FontSemibold.value), Utils_CSS.cls(CSS_Class.Uppercase.value), Utils_CSS.cls(CSS_Class.TrackingWide.value), Utils_CSS.cls(CSS_Class.Mb_3.value), Utils_CSS.cls(CSS_Class.TextCenter.value) ]) ])([ Halogen_HTML_Core.text("Latest Games") ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.RoundedXl.value), Utils_CSS.cls(CSS_Class.P_4.value), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.thm(theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.cls(CSS_Class.Shadow_2xl.value), Utils_CSS.thm(theme)(CSS_ThemeColor.ShadowColor.value) ]) ])([ Halogen_HTML_Elements.table([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.TableFixed.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Elements.colgroup_([ Halogen_HTML_Elements.col([ Utils_CSS.css([ Utils_CSS.raw("w-[25%]") ]) ]), Halogen_HTML_Elements.col([ Utils_CSS.css([ Utils_CSS.raw("w-[10%]") ]) ]), Halogen_HTML_Elements.col([ Utils_CSS.css([ Utils_CSS.raw("w-[30%]") ]) ]), Halogen_HTML_Elements.col([ Utils_CSS.css([ Utils_CSS.raw("w-[10%]") ]) ]), Halogen_HTML_Elements.col([ Utils_CSS.css([ Utils_CSS.raw("w-[25%]") ]) ]) ]), Halogen_HTML_Elements.tbody_(map1(renderGameRow(theme)(p1)(p2))(games)) ]) ]) ]) ]) ]);
            };
        };
    };
};
var renderCenterSection = function (theme) {
    return function (stats) {
        return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.FlexCol.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.JustifyCenter.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.Mb_6.value) ]) ])([ Halogen_HTML_Elements.h1([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.Text_3xl.value), Utils_CSS.cls(CSS_Class.FontBlack.value), Utils_CSS.cls(CSS_Class.Opacity_90.value), Utils_CSS.cls(CSS_Class.TrackingWide.value), Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.LeadingTight.value) ]) ])([ Halogen_HTML_Elements.div_([ Halogen_HTML_Core.text("Career") ]), Halogen_HTML_Elements.div_([ Halogen_HTML_Core.text("Head-to-Head") ]) ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextCenter.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.JustifyCenter.value), Utils_CSS.cls(CSS_Class.Gap_3.value), Utils_CSS.cls(CSS_Class.Mb_3.value) ]) ])([ Halogen_HTML_Elements.span([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Text_5xl.value), Utils_CSS.cls(CSS_Class.FontBlack.value), Utils_CSS.cls(CSS_Class.DropShadowLg.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextAccent.value) ]) ])([ Halogen_HTML_Core.text(show(stats.player1Wins)) ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.RoundedFull.value), Utils_CSS.cls(CSS_Class.W_16.value), Utils_CSS.cls(CSS_Class.H_16.value), Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.JustifyCenter.value), Utils_CSS.cls(CSS_Class.ShadowXl.value), Utils_CSS.cls(CSS_Class.Ring_2.value), Utils_CSS.raw("bg-gradient-to-r from-blue-600 to-purple-600 ring-blue-400/50") ]) ])([ Halogen_HTML_Elements.span([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextWhite.value), Utils_CSS.cls(CSS_Class.FontBlack.value), Utils_CSS.cls(CSS_Class.Text_Lg.value) ]) ])([ Halogen_HTML_Core.text("VS") ]) ]), Halogen_HTML_Elements.span([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Text_5xl.value), Utils_CSS.cls(CSS_Class.FontBlack.value), Utils_CSS.cls(CSS_Class.DropShadowLg.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextAccent.value) ]) ])([ Halogen_HTML_Core.text(show(stats.player2Wins)) ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextCenter.value) ]) ])([ Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Base.value), Utils_CSS.cls(CSS_Class.FontSemibold.value), Utils_CSS.cls(CSS_Class.Uppercase.value), Utils_CSS.cls(CSS_Class.TrackingWide.value) ]) ])([ Halogen_HTML_Core.text("Average Score") ]), Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.Text_2xl.value), Utils_CSS.cls(CSS_Class.FontBold.value) ]) ])([ Halogen_HTML_Core.text(show(stats.player1AvgScore) + ("-" + show(stats.player2AvgScore))) ]) ]) ]) ]);
    };
};
var preparePlayerCardData = function (player) {
    return function (tournament) {
        return function (record) {
            return function (position) {
                var xtPhotoUrl = bind(player.xtData)(function (v) {
                    return v.photourl;
                });
                var placeSeedLabel = Stats_HeadToHeadStats.getPlaceOrSeedLabel(record);
                var location = Utils_Format.formatLocation(player.xtData);
                var imageUrl = Utils_PlayerImage.getPlayerImageUrl(tournament.dataUrl)(player.photo)(xtPhotoUrl);
                return {
                    imageUrl: imageUrl,
                    name: player.name,
                    location: location,
                    record: record,
                    position: position,
                    placeSeedLabel: placeSeedLabel
                };
            };
        };
    };
};
var renderPlayerCard = function (theme) {
    return function (player) {
        return function (tournament) {
            return function (record) {
                return function (position) {
                    return function (isLeft) {
                        var cardData = preparePlayerCardData(player)(tournament)(record)(position);
                        return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.cls(CSS_Class.Rounded_2xl.value), Utils_CSS.cls(CSS_Class.P_4.value), Utils_CSS.cls(CSS_Class.Shadow_2xl.value), Utils_CSS.thm(theme)(CSS_ThemeColor.ShadowColor.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.FlexCol.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css(append1([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.Gap_6.value), Utils_CSS.cls(CSS_Class.Mb_4.value) ])((function () {
                            if (isLeft) {
                                return [  ];
                            };
                            return [ Utils_CSS.cls(CSS_Class.FlexRowReverse.value) ];
                        })())) ])([ Halogen_HTML_Elements.img([ Halogen_HTML_Properties.src(cardData.imageUrl), Halogen_HTML_Properties.alt(cardData.name), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_28.value), Utils_CSS.cls(CSS_Class.H_32.value), Utils_CSS.cls(CSS_Class.RoundedXl.value), Utils_CSS.cls(CSS_Class.ObjectCover.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.raw("border-blue-400/50"), Utils_CSS.cls(CSS_Class.ShadowLg.value) ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css((function () {
                            if (isLeft) {
                                return [  ];
                            };
                            return [ Utils_CSS.cls(CSS_Class.TextRight.value), Utils_CSS.cls(CSS_Class.Flex_1.value) ];
                        })()) ])([ Halogen_HTML_Elements.h2([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.Text_3xl.value), Utils_CSS.cls(CSS_Class.FontBold.value) ]) ])([ Halogen_HTML_Core.text(Utils_Format.formatPlayerName(cardData.name)) ]), (function () {
                            if (cardData.location instanceof Data_Maybe.Just) {
                                return Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Sm.value) ]) ])([ Halogen_HTML_Core.text(cardData.location.value0) ]);
                            };
                            if (cardData.location instanceof Data_Maybe.Nothing) {
                                return Halogen_HTML_Core.text("");
                            };
                            throw new Error("Failed pattern match at Component.Overlay.HeadToHead (line 148, column 21 - line 153, column 44): " + [ cardData.location.constructor.name ]);
                        })() ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css((function () {
                            if (isLeft) {
                                return [  ];
                            };
                            return [ Utils_CSS.cls(CSS_Class.TextRight.value) ];
                        })()) ])([ Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value), Utils_CSS.cls(CSS_Class.Text_Base.value), Utils_CSS.cls(CSS_Class.FontSemibold.value), Utils_CSS.cls(CSS_Class.Uppercase.value), Utils_CSS.cls(CSS_Class.TrackingWide.value), Utils_CSS.cls(CSS_Class.Mb_1.value) ]) ])([ Halogen_HTML_Core.text("Current Record") ]), Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.Text_2xl.value), Utils_CSS.cls(CSS_Class.FontBold.value) ]) ])([ Halogen_HTML_Core.text(show(cardData.record.wins) + ("-" + (show(cardData.record.losses) + (" " + ((function () {
                            var $22 = cardData.record.spread >= 0;
                            if ($22) {
                                return "+";
                            };
                            return "";
                        })() + (show(cardData.record.spread) + (", " + (show(cardData.position) + (Utils_Format.getOrdinalSuffix(cardData.position) + (" " + cardData.placeSeedLabel)))))))))) ]) ]) ]) ]);
                    };
                };
            };
        };
    };
};
var renderHeadToHead = function (v) {
    return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(v.theme)(CSS_ThemeColor.PageBackground.value), Utils_CSS.cls(CSS_Class.MinHScreen.value), Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.JustifyCenter.value), Utils_CSS.cls(CSS_Class.P_4.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.MaxW_7xl.value), Utils_CSS.cls(CSS_Class.W_Full.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Grid.value), Utils_CSS.raw("grid-cols-[2fr_1fr_2fr]"), Utils_CSS.cls(CSS_Class.Gap_2.value), Utils_CSS.cls(CSS_Class.MaxW_6xl.value), Utils_CSS.cls(CSS_Class.Mx_Auto.value) ]) ])([ renderPlayerCard(v.theme)(v.player1)(v.tournament)(v.stats.player1Record)(v.stats.player1Position)(true), renderCenterSection(v.theme)(v.stats), renderPlayerCard(v.theme)(v.player2)(v.tournament)(v.stats.player2Record)(v.stats.player2Position)(false) ]), renderGamesTable(v.theme)(v.player1)(v.player2)(v.recentGames) ]) ]);
};
var prepareH2HViewData = function (theme) {
    return function (p1) {
        return function (p2) {
            return function (tournament) {
                return function (division) {
                    var h2hGames = Stats_HeadToHeadStats.getHeadToHeadGames(p1)(p2)(division)(tournament);
                    var recentGames = Data_Array.take(5)(Stats_HeadToHeadStats.sortGames(h2hGames));
                    var stats = Stats_HeadToHeadStats.calculateH2HStats(p1)(p2)(h2hGames)(division);
                    return {
                        theme: theme,
                        player1: p1,
                        player2: p2,
                        tournament: tournament,
                        stats: stats,
                        recentGames: recentGames
                    };
                };
            };
        };
    };
};
var render = function (state) {
    return Component_Overlay_BaseOverlay.renderWithData(state)(function (tournamentData) {
        var maybePlayers = Stats_HeadToHeadStats.resolveAndFindPlayers(state.extra.playerId1)(state.extra.playerId2)(state.currentMatch)(tournamentData.division);
        if (maybePlayers instanceof Data_Maybe.Nothing) {
            return Component_Overlay_BaseOverlay.renderError("Players not found in division");
        };
        if (maybePlayers instanceof Data_Maybe.Just) {
            var viewData = prepareH2HViewData(state.theme)(maybePlayers.value0.player1)(maybePlayers.value0.player2)(tournamentData.tournament)(tournamentData.division);
            return renderHeadToHead(viewData);
        };
        throw new Error("Failed pattern match at Component.Overlay.HeadToHead (line 70, column 7 - line 74, column 39): " + [ maybePlayers.constructor.name ]);
    });
};
var component = function (dictMonadAff) {
    var mkComponent = Component_Overlay_BaseOverlay.mkComponent(dictMonadAff);
    return function (dictMonadBroadcast) {
        var mkComponent1 = mkComponent(dictMonadBroadcast);
        return function (dictMonadEmitters) {
            return mkComponent1(dictMonadEmitters)(render);
        };
    };
};
export {
    component,
    prepareH2HViewData,
    render,
    renderHeadToHead,
    preparePlayerCardData,
    renderPlayerCard,
    renderCenterSection,
    renderGamesTable,
    renderGameRow
};
