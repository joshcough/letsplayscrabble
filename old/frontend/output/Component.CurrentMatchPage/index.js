// Generated by purs version 0.15.15
import * as Backend_MonadBackend from "../Backend.MonadBackend/index.js";
import * as CSS_Class from "../CSS.Class/index.js";
import * as CSS_ThemeColor from "../CSS.ThemeColor/index.js";
import * as Component_CurrentMatchPageHelpers from "../Component.CurrentMatchPageHelpers/index.js";
import * as Config_Themes from "../Config.Themes/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_Error_Class from "../Control.Monad.Error.Class/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as Control_Monad_Trans_Class from "../Control.Monad.Trans.Class/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Foldable from "../Data.Foldable/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Ord from "../Data.Ord/index.js";
import * as Data_Semigroup from "../Data.Semigroup/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Effect_Unsafe from "../Effect.Unsafe/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Utils_Auth from "../Utils.Auth/index.js";
import * as Utils_CSS from "../Utils.CSS/index.js";
import * as Utils_Halogen from "../Utils.Halogen/index.js";
import * as Utils_Logger from "../Utils.Logger/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var value = /* #__PURE__ */ Halogen_HTML_Properties.value(Halogen_HTML_Core.isPropString);
var append1 = /* #__PURE__ */ Data_Semigroup.append(Data_Semigroup.semigroupArray);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var compare = /* #__PURE__ */ Data_Ord.compare(Data_Ord.ordString);
var map1 = /* #__PURE__ */ Data_Functor.map(Data_Maybe.functorMaybe);
var bind = /* #__PURE__ */ Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM);
var get = /* #__PURE__ */ Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var bind1 = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var for_ = /* #__PURE__ */ Data_Foldable.for_(Halogen_Query_HalogenM.applicativeHalogenM)(Data_Foldable.foldableMaybe);
var lift = /* #__PURE__ */ Control_Monad_Trans_Class.lift(Halogen_Query_HalogenM.monadTransHalogenM);
var join = /* #__PURE__ */ Control_Bind.join(Data_Maybe.bindMaybe);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showBoolean);
var when = /* #__PURE__ */ Control_Applicative.when(Halogen_Query_HalogenM.applicativeHalogenM);
var show2 = /* #__PURE__ */ Data_Show.show(/* #__PURE__ */ Data_Maybe.showMaybe(Data_Show.showInt));
var eq2 = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqInt));
var NavigateBack = /* #__PURE__ */ (function () {
    function NavigateBack() {

    };
    NavigateBack.value = new NavigateBack();
    return NavigateBack;
})();
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var LoadTournaments = /* #__PURE__ */ (function () {
    function LoadTournaments() {

    };
    LoadTournaments.value = new LoadTournaments();
    return LoadTournaments;
})();
var SelectTournament = /* #__PURE__ */ (function () {
    function SelectTournament(value0) {
        this.value0 = value0;
    };
    SelectTournament.create = function (value0) {
        return new SelectTournament(value0);
    };
    return SelectTournament;
})();
var SelectDivision = /* #__PURE__ */ (function () {
    function SelectDivision(value0) {
        this.value0 = value0;
    };
    SelectDivision.create = function (value0) {
        return new SelectDivision(value0);
    };
    return SelectDivision;
})();
var SelectRound = /* #__PURE__ */ (function () {
    function SelectRound(value0) {
        this.value0 = value0;
    };
    SelectRound.create = function (value0) {
        return new SelectRound(value0);
    };
    return SelectRound;
})();
var SelectPairing = /* #__PURE__ */ (function () {
    function SelectPairing(value0) {
        this.value0 = value0;
    };
    SelectPairing.create = function (value0) {
        return new SelectPairing(value0);
    };
    return SelectPairing;
})();
var UpdateMatch = /* #__PURE__ */ (function () {
    function UpdateMatch() {

    };
    UpdateMatch.value = new UpdateMatch();
    return UpdateMatch;
})();
var HandleBackClick = /* #__PURE__ */ (function () {
    function HandleBackClick() {

    };
    HandleBackClick.value = new HandleBackClick();
    return HandleBackClick;
})();
var renderTournamentSelect = function (state) {
    var tournamentOption = function (t) {
        var isSelected = show(t.id) === state.selectedTournamentId;
        return Halogen_HTML_Elements.option([ value(show(t.id)), Halogen_HTML_Properties.selected(isSelected) ])([ Halogen_HTML_Core.text(t.longFormName) ]);
    };
    return Halogen_HTML_Elements.div([  ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Tournament (" + (show(Data_Array.length(state.tournaments)) + " available)")) ]), Halogen_HTML_Elements.select([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormInput.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.SecondaryBorder.value) ]), value(state.selectedTournamentId), Halogen_HTML_Events.onValueChange(SelectTournament.create), Halogen_HTML_Properties.disabled(state.loading) ])(append1([ Halogen_HTML_Elements.option([ value("") ])([ Halogen_HTML_Core.text("Select Tournament") ]) ])(map(tournamentOption)(Data_Array.sortBy(function (a) {
        return function (b) {
            return compare(a.name)(b.name);
        };
    })(state.tournaments)))) ]);
};
var renderDivisionSelect = function (state) {
    var divisionOption = function (d) {
        var isSelected = show(d.id) === state.selectedDivisionId;
        return Halogen_HTML_Elements.option([ value(show(d.id)), Halogen_HTML_Properties.selected(isSelected) ])([ Halogen_HTML_Core.text(d.name) ]);
    };
    var divisions = Data_Maybe.fromMaybe([  ])(map1(function (v) {
        return v.divisions;
    })(state.selectedTournament));
    var v = Effect_Unsafe.unsafePerformEffect(Utils_Logger.log("[renderDivisionSelect] divisions count=" + (show(Data_Array.length(divisions)) + (" selectedDivisionId=" + state.selectedDivisionId))));
    return Halogen_HTML_Elements.div([  ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Division (" + (show(Data_Array.length(divisions)) + " available)")) ]), Halogen_HTML_Elements.select([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormInput.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.SecondaryBorder.value) ]), value(state.selectedDivisionId), Halogen_HTML_Events.onValueChange(SelectDivision.create), Halogen_HTML_Properties.disabled(state.selectedTournamentId === "" || state.loading) ])(append1([ Halogen_HTML_Elements.option([ value("") ])([ Halogen_HTML_Core.text("Select Division") ]) ])(map(divisionOption)(divisions))) ]);
};
var initialState = function (v) {
    return {
        userId: Data_Maybe.Nothing.value,
        theme: Config_Themes.getTheme("scrabble"),
        tournaments: [  ],
        selectedTournament: Data_Maybe.Nothing.value,
        selectedTournamentId: "",
        selectedDivisionId: "",
        selectedRound: "",
        selectedPairingId: Data_Maybe.Nothing.value,
        loading: true,
        error: Data_Maybe.Nothing.value,
        success: Data_Maybe.Nothing.value
    };
};
var handleUpdateMatch = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var setCurrentMatch = Backend_MonadBackend.setCurrentMatch(dictMonadBackend);
    return bind(get)(function (state) {
        var v1 = Data_Int.fromString(state.selectedRound);
        var v2 = Data_Int.fromString(state.selectedDivisionId);
        var v3 = Data_Int.fromString(state.selectedTournamentId);
        if (state.userId instanceof Data_Maybe.Just && (v3 instanceof Data_Maybe.Just && (v2 instanceof Data_Maybe.Just && (v1 instanceof Data_Maybe.Just && state.selectedPairingId instanceof Data_Maybe.Just)))) {
            return discard(modify_(function (v5) {
                var $100 = {};
                for (var $101 in v5) {
                    if ({}.hasOwnProperty.call(v5, $101)) {
                        $100[$101] = v5[$101];
                    };
                };
                $100.success = Data_Maybe.Nothing.value;
                return $100;
            }))(function () {
                var request = {
                    tournamentId: v3.value0,
                    divisionId: v2.value0,
                    round: v1.value0,
                    pairingId: state.selectedPairingId.value0
                };
                return withLoading(setCurrentMatch(request))(function (v5) {
                    return modify_(function (v6) {
                        var $103 = {};
                        for (var $104 in v6) {
                            if ({}.hasOwnProperty.call(v6, $104)) {
                                $103[$104] = v6[$104];
                            };
                        };
                        $103.success = new Data_Maybe.Just("Match updated successfully!");
                        return $103;
                    });
                });
            });
        };
        return modify_(function (v5) {
            var $111 = {};
            for (var $112 in v5) {
                if ({}.hasOwnProperty.call(v5, $112)) {
                    $111[$112] = v5[$112];
                };
            };
            $111.error = new Data_Maybe.Just("Please select all fields");
            return $111;
        });
    });
};
var getRoundsForDivision = function (state) {
    return Data_Maybe.fromMaybe([  ])(bind1(state.selectedTournament)(function (tournament) {
        return bind1(Data_Int.fromString(state.selectedDivisionId))(function (divId) {
            return Component_CurrentMatchPageHelpers.getRoundsForDivision(tournament)(divId);
        });
    }));
};
var renderRoundSelect = function (state) {
    var roundOption = function (r) {
        var isSelected = show(r) === state.selectedRound;
        return Halogen_HTML_Elements.option([ value(show(r)), Halogen_HTML_Properties.selected(isSelected) ])([ Halogen_HTML_Core.text("Round " + show(r)) ]);
    };
    var rounds = getRoundsForDivision(state);
    var v = Effect_Unsafe.unsafePerformEffect(Utils_Logger.log("[renderRoundSelect] rounds count=" + (show(Data_Array.length(rounds)) + (" selectedRound=" + state.selectedRound))));
    return Halogen_HTML_Elements.div([  ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Round (" + (show(Data_Array.length(rounds)) + " available)")) ]), Halogen_HTML_Elements.select([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormInput.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.SecondaryBorder.value) ]), value(state.selectedRound), Halogen_HTML_Events.onValueChange(SelectRound.create), Halogen_HTML_Properties.disabled(state.selectedDivisionId === "" || state.loading) ])(append1([ Halogen_HTML_Elements.option([ value("") ])([ Halogen_HTML_Core.text("Select Round") ]) ])(map(roundOption)(rounds))) ]);
};
var getPlayerName = function (state) {
    return function (playerId) {
        return Data_Maybe.fromMaybe("Unknown")(bind1(state.selectedTournament)(function (tournament) {
            return bind1(Data_Int.fromString(state.selectedDivisionId))(function (divId) {
                return bind1(Data_Array.find(function (d) {
                    return d.id === divId;
                })(tournament.divisions))(function (division) {
                    return Component_CurrentMatchPageHelpers.getPlayerName(division.players)(playerId);
                });
            });
        }));
    };
};
var getPairingsForRound = function (state) {
    return Data_Maybe.fromMaybe([  ])(bind1(state.selectedTournament)(function (tournament) {
        return bind1(Data_Int.fromString(state.selectedDivisionId))(function (divId) {
            return bind1(Data_Array.find(function (d) {
                return d.id === divId;
            })(tournament.divisions))(function (division) {
                return bind1(Data_Int.fromString(state.selectedRound))(function (roundNum) {
                    return pure(Component_CurrentMatchPageHelpers.getPairingsForRound(division)(roundNum));
                });
            });
        });
    }));
};
var handleTournamentsLoaded = function (dictMonadBackend) {
    var MonadError0 = dictMonadBackend.MonadError0();
    var lift1 = lift((MonadError0.MonadThrow0()).Monad0());
    var $$try = Control_Monad_Error_Class["try"](MonadError0);
    var getCurrentMatch = Backend_MonadBackend.getCurrentMatch(dictMonadBackend);
    return function (dictMonadEffect) {
        var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadEffect));
        return function (tournaments) {
            return discard(modify_(function (v) {
                var $116 = {};
                for (var $117 in v) {
                    if ({}.hasOwnProperty.call(v, $117)) {
                        $116[$117] = v[$117];
                    };
                };
                $116.tournaments = tournaments;
                return $116;
            }))(function () {
                return bind(get)(function (state) {
                    return for_(state.userId)(function (uid) {
                        return bind(lift1($$try(getCurrentMatch(uid))))(function (result) {
                            return for_(join(Data_Either.hush(result)))(function (match) {
                                return discard(liftEffect(Utils_Logger.log("[CurrentMatch] Loaded current match: tid=" + (show(match.tournamentId) + (" did=" + (show(match.divisionId) + (" round=" + (show(match.round) + (" pid=" + show(match.pairingId))))))))))(function () {
                                    return discard(modify_(function (v) {
                                        var $122 = {};
                                        for (var $123 in v) {
                                            if ({}.hasOwnProperty.call(v, $123)) {
                                                $122[$123] = v[$123];
                                            };
                                        };
                                        $122.selectedTournamentId = show(match.tournamentId);
                                        $122.selectedDivisionId = show(match.divisionId);
                                        $122.selectedRound = show(match.round);
                                        $122.selectedPairingId = new Data_Maybe.Just(match.pairingId);
                                        return $122;
                                    }))(function () {
                                        return handleAction(dictMonadBackend)(dictMonadEffect)(new SelectTournament(show(match.tournamentId)));
                                    });
                                });
                            });
                        });
                    });
                });
            });
        };
    };
};
var handleSelectTournament = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var getTournament = Backend_MonadBackend.getTournament(dictMonadBackend);
    return function (dictMonadEffect) {
        var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadEffect));
        return function (tidStr) {
            return bind(get)(function (state) {
                var preserveSelections = state.selectedTournamentId === tidStr && state.selectedDivisionId !== "";
                return discard(liftEffect(Utils_Logger.log("[SelectTournament] tidStr=" + (tidStr + (" preserveSelections=" + (show1(preserveSelections) + (" currentDivId=" + state.selectedDivisionId)))))))(function () {
                    return discard(when(!preserveSelections)(modify_(function (v) {
                        var $125 = {};
                        for (var $126 in v) {
                            if ({}.hasOwnProperty.call(v, $126)) {
                                $125[$126] = v[$126];
                            };
                        };
                        $125.selectedTournamentId = tidStr;
                        $125.selectedDivisionId = "";
                        $125.selectedRound = "";
                        $125.selectedPairingId = Data_Maybe.Nothing.value;
                        return $125;
                    })))(function () {
                        return discard(modify_(function (v) {
                            var $128 = {};
                            for (var $129 in v) {
                                if ({}.hasOwnProperty.call(v, $129)) {
                                    $128[$129] = v[$129];
                                };
                            };
                            $128.selectedTournamentId = tidStr;
                            return $128;
                        }))(function () {
                            return for_(Data_Int.fromString(tidStr))(function (tid) {
                                return bind(get)(function (currentState) {
                                    return for_(currentState.userId)(function (uid) {
                                        return withLoading(getTournament(uid)(tid))(function (tournament) {
                                            return discard(modify_(function (v) {
                                                var $131 = {};
                                                for (var $132 in v) {
                                                    if ({}.hasOwnProperty.call(v, $132)) {
                                                        $131[$132] = v[$132];
                                                    };
                                                };
                                                $131.selectedTournament = new Data_Maybe.Just(tournament);
                                                return $131;
                                            }))(function () {
                                                return bind(get)(function (finalState) {
                                                    return discard(liftEffect(Utils_Logger.log("[SelectTournament] After loading tournament: selectedDivId=" + (finalState.selectedDivisionId + (" selectedRound=" + (finalState.selectedRound + (" selectedPairingId=" + show2(finalState.selectedPairingId))))))))(function () {
                                                        return when(!preserveSelections)(for_(Data_Array.head(tournament.divisions))(function (division) {
                                                            return handleAction(dictMonadBackend)(dictMonadEffect)(new SelectDivision(show(division.id)));
                                                        }));
                                                    });
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        };
    };
};
var handleAction = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var listTournaments = Backend_MonadBackend.listTournaments(dictMonadBackend);
    var handleUpdateMatch1 = handleUpdateMatch(dictMonadBackend);
    return function (dictMonadEffect) {
        var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadEffect));
        return function (v) {
            if (v instanceof Initialize) {
                return bind(liftEffect(Utils_Auth.getUserId))(function (userId) {
                    return discard(modify_(function (v1) {
                        var $136 = {};
                        for (var $137 in v1) {
                            if ({}.hasOwnProperty.call(v1, $137)) {
                                $136[$137] = v1[$137];
                            };
                        };
                        $136.userId = userId;
                        return $136;
                    }))(function () {
                        return handleAction(dictMonadBackend)(dictMonadEffect)(LoadTournaments.value);
                    });
                });
            };
            if (v instanceof LoadTournaments) {
                return withLoading(listTournaments)(handleTournamentsLoaded(dictMonadBackend)(dictMonadEffect));
            };
            if (v instanceof SelectTournament) {
                return handleSelectTournament(dictMonadBackend)(dictMonadEffect)(v.value0);
            };
            if (v instanceof SelectDivision) {
                return discard(modify_(function (v1) {
                    var $140 = {};
                    for (var $141 in v1) {
                        if ({}.hasOwnProperty.call(v1, $141)) {
                            $140[$141] = v1[$141];
                        };
                    };
                    $140.selectedDivisionId = v.value0;
                    $140.selectedRound = "";
                    $140.selectedPairingId = Data_Maybe.Nothing.value;
                    return $140;
                }))(function () {
                    return bind(get)(function (state) {
                        var rounds = getRoundsForDivision(state);
                        return for_(Data_Array.head(rounds))(function (r) {
                            return handleAction(dictMonadBackend)(dictMonadEffect)(new SelectRound(show(r)));
                        });
                    });
                });
            };
            if (v instanceof SelectRound) {
                return discard(modify_(function (v1) {
                    var $144 = {};
                    for (var $145 in v1) {
                        if ({}.hasOwnProperty.call(v1, $145)) {
                            $144[$145] = v1[$145];
                        };
                    };
                    $144.selectedRound = v.value0;
                    $144.selectedPairingId = Data_Maybe.Nothing.value;
                    return $144;
                }))(function () {
                    return bind(get)(function (state) {
                        var pairings = getPairingsForRound(state);
                        return for_(Data_Array.head(pairings))(function (game) {
                            return for_(game.pairingId)(function (v1) {
                                return modify_(function (v2) {
                                    var $148 = {};
                                    for (var $149 in v2) {
                                        if ({}.hasOwnProperty.call(v2, $149)) {
                                            $148[$149] = v2[$149];
                                        };
                                    };
                                    $148.selectedPairingId = new Data_Maybe.Just(v1);
                                    return $148;
                                });
                            });
                        });
                    });
                });
            };
            if (v instanceof SelectPairing) {
                return modify_(function (v1) {
                    var $152 = {};
                    for (var $153 in v1) {
                        if ({}.hasOwnProperty.call(v1, $153)) {
                            $152[$153] = v1[$153];
                        };
                    };
                    $152.selectedPairingId = Data_Int.fromString(v.value0);
                    return $152;
                });
            };
            if (v instanceof UpdateMatch) {
                return handleUpdateMatch1;
            };
            if (v instanceof HandleBackClick) {
                return Halogen_Query_HalogenM.raise(NavigateBack.value);
            };
            throw new Error("Failed pattern match at Component.CurrentMatchPage (line 277, column 16 - line 309, column 42): " + [ v.constructor.name ]);
        };
    };
};
var renderPairingSelect = function (state) {
    var pairingOption = function (s) {
        return function (game) {
            var v = Data_Maybe.fromMaybe(0)(game.pairingId);
            var player2Name = (function () {
                if (game.isBye) {
                    return "BYE";
                };
                return getPlayerName(s)(game.player2Id);
            })();
            var player1Name = getPlayerName(s)(game.player1Id);
            var isSelected = (function () {
                if (s.selectedPairingId instanceof Data_Maybe.Just) {
                    return v === s.selectedPairingId.value0;
                };
                if (s.selectedPairingId instanceof Data_Maybe.Nothing) {
                    return false;
                };
                throw new Error("Failed pattern match at Component.CurrentMatchPage (line 241, column 24 - line 243, column 29): " + [ s.selectedPairingId.constructor.name ]);
            })();
            return Halogen_HTML_Elements.option([ value(show(v)), Halogen_HTML_Properties.selected(isSelected) ])([ Halogen_HTML_Core.text(player1Name + (" vs " + player2Name)) ]);
        };
    };
    var pairings = getPairingsForRound(state);
    var v = Effect_Unsafe.unsafePerformEffect(Utils_Logger.log("[renderPairingSelect] pairings count=" + (show(Data_Array.length(pairings)) + (" selectedPairingId=" + show2(state.selectedPairingId)))));
    return Halogen_HTML_Elements.div([  ])([ Halogen_HTML_Elements.label([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormLabel.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Pairing (" + (show(Data_Array.length(pairings)) + " available)")) ]), Halogen_HTML_Elements.select([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FormInput.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.SecondaryBorder.value) ]), value(Data_Maybe.fromMaybe("")(map1(show)(state.selectedPairingId))), Halogen_HTML_Events.onValueChange(SelectPairing.create), Halogen_HTML_Properties.disabled(state.selectedRound === "" || state.loading) ])(append1([ Halogen_HTML_Elements.option([ value("") ])([ Halogen_HTML_Core.text("Select Pairing") ]) ])(map(pairingOption(state))(pairings))) ]);
};
var render = function (state) {
    var buttonClass = function (s) {
        var $162 = s.loading || eq2(s.selectedPairingId)(Data_Maybe.Nothing.value);
        if ($162) {
            return "opacity-50 cursor-not-allowed bg-gray-300";
        };
        return Utils_CSS.classes([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value) ]);
    };
    return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.MinHScreen.value), Utils_CSS.cls(CSS_Class.P_8.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PageBackground.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.MaxW_4xl.value), Utils_CSS.cls(CSS_Class.Mx_Auto.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.P_6.value) ]) ])([ Halogen_HTML_Elements.h1([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.PageTitle.value), Utils_CSS.cls(CSS_Class.Mb_6.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Current Match Management") ]), (function () {
        if (state.error instanceof Data_Maybe.Just) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.raw("border-red-700/20 bg-red-700/10"), Utils_CSS.cls(CSS_Class.TextRed700.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.cls(CSS_Class.Mb_4.value) ]) ])([ Halogen_HTML_Core.text(state.error.value0) ]);
        };
        if (state.error instanceof Data_Maybe.Nothing) {
            return Halogen_HTML_Core.text("");
        };
        throw new Error("Failed pattern match at Component.CurrentMatchPage (line 96, column 11 - line 101, column 34): " + [ state.error.constructor.name ]);
    })(), (function () {
        if (state.success instanceof Data_Maybe.Just) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.raw("border-green-700/20 bg-green-700/10"), Utils_CSS.cls(CSS_Class.TextGreen700.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.cls(CSS_Class.Mb_4.value) ]) ])([ Halogen_HTML_Core.text(state.success.value0) ]);
        };
        if (state.success instanceof Data_Maybe.Nothing) {
            return Halogen_HTML_Core.text("");
        };
        throw new Error("Failed pattern match at Component.CurrentMatchPage (line 102, column 11 - line 107, column 34): " + [ state.success.constructor.name ]);
    })(), (function () {
        var $167 = state.loading && Data_Array["null"](state.tournaments);
        if ($167) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextCenter.value), Utils_CSS.cls(CSS_Class.Py_8.value) ]) ])([ Halogen_HTML_Core.text("Loading...") ]);
        };
        return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.SpaceY_6.value) ]) ])([ renderTournamentSelect(state), renderDivisionSelect(state), renderRoundSelect(state), renderPairingSelect(state), Halogen_HTML_Elements.button([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.RoundedMd.value), Utils_CSS.raw(buttonClass(state)) ]), Halogen_HTML_Properties.disabled(state.loading || eq2(state.selectedPairingId)(Data_Maybe.Nothing.value)), Halogen_HTML_Events.onClick(function (v) {
            return UpdateMatch.value;
        }) ])([ Halogen_HTML_Core.text((function () {
            if (state.loading) {
                return "Updating...";
            };
            return "Update Match";
        })()) ]), Halogen_HTML_Elements.button([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.cls(CSS_Class.FocusOutlineNone.value), Utils_CSS.cls(CSS_Class.FocusRing_2.value), Utils_CSS.cls(CSS_Class.TransitionColors.value), Utils_CSS.hover("bg-gray-50") ]), Halogen_HTML_Events.onClick(function (v) {
            return HandleBackClick.value;
        }) ])([ Halogen_HTML_Core.text("Back to List") ]) ]);
    })() ]) ]);
};
var component = function (dictMonadBackend) {
    var handleAction1 = handleAction(dictMonadBackend);
    return function (dictMonadEffect) {
        return Halogen_Component.mkComponent({
            initialState: initialState,
            render: render,
            "eval": Halogen_Component.mkEval({
                handleQuery: Halogen_Component.defaultEval.handleQuery,
                receive: Halogen_Component.defaultEval.receive,
                finalize: Halogen_Component.defaultEval.finalize,
                handleAction: handleAction1(dictMonadEffect),
                initialize: new Data_Maybe.Just(Initialize.value)
            })
        });
    };
};
export {
    Initialize,
    LoadTournaments,
    SelectTournament,
    SelectDivision,
    SelectRound,
    SelectPairing,
    UpdateMatch,
    HandleBackClick,
    NavigateBack,
    component,
    initialState,
    render,
    renderTournamentSelect,
    renderDivisionSelect,
    renderRoundSelect,
    renderPairingSelect,
    getRoundsForDivision,
    getPairingsForRound,
    getPlayerName,
    handleAction,
    handleTournamentsLoaded,
    handleSelectTournament,
    handleUpdateMatch
};
