// Generated by purs version 0.15.15
import * as Control_Alt from "../Control.Alt/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Array from "../Data.Array/index.js";
import * as Data_Boolean from "../Data.Boolean/index.js";
import * as Data_EuclideanRing from "../Data.EuclideanRing/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Number from "../Data.Number/index.js";
import * as Data_Number_Format from "../Data.Number.Format/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_String_CodePoints from "../Data.String.CodePoints/index.js";
import * as Data_String_CodeUnits from "../Data.String.CodeUnits/index.js";
import * as Data_String_Common from "../Data.String.Common/index.js";
var bind = /* #__PURE__ */ Control_Bind.bind(Data_Maybe.bindMaybe);
var alt = /* #__PURE__ */ Control_Alt.alt(Data_Maybe.altMaybe);
var mod = /* #__PURE__ */ Data_EuclideanRing.mod(Data_EuclideanRing.euclideanRingInt);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var show1 = /* #__PURE__ */ Data_Show.show(Data_Show.showNumber);
var pure = /* #__PURE__ */ Control_Applicative.pure(Data_Maybe.applicativeMaybe);
var getRecentTournament = function (xtData) {
    return bind(bind(xtData)(function (v) {
        return v.results;
    }))(function (results) {
        return alt(Data_Array.find(function (r) {
            return r.place === 1;
        })(results))(Data_Array.head(results));
    });
};
var getRanking = function (xtData) {
    return bind(xtData)(function (data$prime) {
        return alt(data$prime.twlranking)(data$prime.cswranking);
    });
};
var getOrdinalSuffix = function (num) {
    var k = mod(num)(100);
    var j = mod(num)(10);
    var $24 = j === 1 && k !== 11;
    if ($24) {
        return "st";
    };
    var $25 = j === 2 && k !== 12;
    if ($25) {
        return "nd";
    };
    var $26 = j === 3 && k !== 13;
    if ($26) {
        return "rd";
    };
    return "th";
};
var getCurrentRating = function (player) {
    if (player.ratingsHistory.length === 0) {
        return new Data_Maybe.Just(player.initialRating);
    };
    return alt(Data_Array.last(player.ratingsHistory))(new Data_Maybe.Just(player.initialRating));
};
var formatWithCommas = function (n) {
    var str = show(n);
    var len = Data_String_CodePoints.length(str);
    var go = function ($copy_idx) {
        return function ($copy_acc) {
            var $tco_var_idx = $copy_idx;
            var $tco_done = false;
            var $tco_result;
            function $tco_loop(idx, acc) {
                var $28 = idx <= 0;
                if ($28) {
                    $tco_done = true;
                    return acc;
                };
                var needsComma = mod(idx)(3) === 0 && idx < len;
                var digitIdx = len - idx | 0;
                var digit = Data_String_CodePoints.take(1)(Data_String_CodePoints.drop(digitIdx)(str));
                $tco_var_idx = idx - 1 | 0;
                $copy_acc = acc + (digit + (function () {
                    if (needsComma) {
                        return ",";
                    };
                    return "";
                })());
                return;
            };
            while (!$tco_done) {
                $tco_result = $tco_loop($tco_var_idx, $copy_acc);
            };
            return $tco_result;
        };
    };
    return go(len)("");
};
var formatRankOrdinal = function (rank) {
    return show(rank) + getOrdinalSuffix(rank);
};
var formatPlayerName = function (name) {
    var v = Data_String_CodePoints.indexOf(",")(name);
    if (v instanceof Data_Maybe.Nothing) {
        return name;
    };
    if (v instanceof Data_Maybe.Just) {
        var rest = Data_String_CodeUnits.drop(v.value0 + 1 | 0)(name);
        var lastName = Data_String_CodeUnits.take(v.value0)(name);
        var firstName = Data_String_Common.trim(rest);
        return firstName + (" " + lastName);
    };
    throw new Error("Failed pattern match at Utils.Format (line 26, column 3 - line 34, column 37): " + [ v.constructor.name ]);
};
var getInitials = function (name) {
    var formatted = formatPlayerName(name);
    var words = Data_String_Common.split(" ")(formatted);
    var initials = map(function (w) {
        return Data_Maybe.fromMaybe("")(Data_Array.head(Data_String_Common.split("")(w)));
    })(words);
    return Data_String_Common.joinWith("")(initials);
};
var formatPercent = function (n) {
    var rounded = Data_Int.toNumber(Data_Int.round(n * 10.0)) / 10.0;
    return Data_Number_Format.toStringWith(Data_Number_Format.fixed(1))(rounded) + "%";
};
var formatNumberWithSign = function (n) {
    if (n > 0) {
        return "+" + show(n);
    };
    if (Data_Boolean.otherwise) {
        return show(n);
    };
    throw new Error("Failed pattern match at Utils.Format (line 18, column 1 - line 18, column 38): " + [ n.constructor.name ]);
};
var formatNumber = function (num) {
    return function (decimals) {
        var factor = Data_Number.pow(10.0)(Data_Int.toNumber(decimals));
        var rounded = Data_Int.toNumber(Data_Int.round(num * factor)) / factor;
        return show1(rounded);
    };
};
var formatLocation = function (v) {
    if (v instanceof Data_Maybe.Nothing) {
        return Data_Maybe.Nothing.value;
    };
    if (v instanceof Data_Maybe.Just) {
        if (v.value0.city instanceof Data_Maybe.Nothing) {
            return Data_Maybe.Nothing.value;
        };
        if (v.value0.city instanceof Data_Maybe.Just) {
            return new Data_Maybe.Just((function () {
                if (v.value0.state instanceof Data_Maybe.Just) {
                    return v.value0.city.value0 + (", " + v.value0.state.value0);
                };
                if (v.value0.state instanceof Data_Maybe.Nothing) {
                    return v.value0.city.value0;
                };
                throw new Error("Failed pattern match at Utils.Format (line 43, column 25 - line 45, column 22): " + [ v.value0.state.constructor.name ]);
            })());
        };
        throw new Error("Failed pattern match at Utils.Format (line 41, column 3 - line 45, column 22): " + [ v.value0.city.constructor.name ]);
    };
    throw new Error("Failed pattern match at Utils.Format (line 38, column 1 - line 38, column 74): " + [ v.constructor.name ]);
};
var formatDate = function (dateString) {
    var v = Data_String_Common.split("-")(dateString);
    if (v.length === 3) {
        var monthName = (function () {
            if (v[1] === "01") {
                return "Jan";
            };
            if (v[1] === "02") {
                return "Feb";
            };
            if (v[1] === "03") {
                return "Mar";
            };
            if (v[1] === "04") {
                return "Apr";
            };
            if (v[1] === "05") {
                return "May";
            };
            if (v[1] === "06") {
                return "Jun";
            };
            if (v[1] === "07") {
                return "Jul";
            };
            if (v[1] === "08") {
                return "Aug";
            };
            if (v[1] === "09") {
                return "Sep";
            };
            if (v[1] === "10") {
                return "Oct";
            };
            if (v[1] === "11") {
                return "Nov";
            };
            if (v[1] === "12") {
                return "Dec";
            };
            return v[1];
        })();
        var dayNum = (function () {
            if (Data_String_CodePoints.take(1)(v[2]) === "0") {
                return Data_String_CodePoints.drop(1)(v[2]);
            };
            return v[2];
        })();
        return monthName + (" " + (dayNum + (", " + v[0])));
    };
    return dateString;
};
var calculateWinPercentage = function (xtData) {
    return bind(xtData)(function (data$prime) {
        return bind(data$prime.w)(function (wins) {
            return bind(data$prime.l)(function (losses) {
                return bind(data$prime.t)(function (ties) {
                    var totalGames = (wins + losses | 0) + ties | 0;
                    var $45 = totalGames === 0;
                    if ($45) {
                        return pure(0.0);
                    };
                    var effectiveWins = Data_Int.toNumber(wins) + Data_Int.toNumber(ties) * 0.5;
                    var percentage = (effectiveWins / Data_Int.toNumber(totalGames)) * 100.0;
                    return pure(Data_Int.toNumber(Data_Int.round(percentage * 10.0)) / 10.0);
                });
            });
        });
    });
};
var abbreviateTournamentName = function (name) {
    return Data_String_Common.replace("Invitational")("Invit'l")(Data_String_Common.replace("National")("Nat'l")(Data_String_Common.replace("Tournament")("Tourney")(Data_String_Common.replace("International")("Int'l")(name))));
};
export {
    formatNumberWithSign,
    formatPlayerName,
    formatLocation,
    getOrdinalSuffix,
    formatRankOrdinal,
    abbreviateTournamentName,
    getInitials,
    formatNumber,
    formatDate,
    getCurrentRating,
    getRanking,
    calculateWinPercentage,
    getRecentTournament,
    formatWithCommas,
    formatPercent
};
