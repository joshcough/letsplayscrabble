// Generated by purs version 0.15.15
import * as Backend_MonadBackend from "../Backend.MonadBackend/index.js";
import * as CSS_Class from "../CSS.Class/index.js";
import * as CSS_ThemeColor from "../CSS.ThemeColor/index.js";
import * as Config_Themes from "../Config.Themes/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as Data_Eq from "../Data.Eq/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Domain_Types from "../Domain.Types/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Utils_CSS from "../Utils.CSS/index.js";
import * as Utils_Halogen from "../Utils.Halogen/index.js";
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var eq = /* #__PURE__ */ Data_Eq.eq(/* #__PURE__ */ Data_Eq.eqArray(/* #__PURE__ */ Data_Eq.eqRec()(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(/* #__PURE__ */ Data_Eq.eqRowCons(Data_Eq.eqRowNil)()({
    reflectSymbol: function () {
        return "year";
    }
})(Data_Eq.eqInt))()({
    reflectSymbol: function () {
        return "transparentBackground";
    }
})(Data_Eq.eqBoolean))()({
    reflectSymbol: function () {
        return "theme";
    }
})(Data_Eq.eqString))()({
    reflectSymbol: function () {
        return "pollUntil";
    }
})(/* #__PURE__ */ Data_Maybe.eqMaybe(Data_Eq.eqString)))()({
    reflectSymbol: function () {
        return "name";
    }
})(Data_Eq.eqString))()({
    reflectSymbol: function () {
        return "longFormName";
    }
})(Data_Eq.eqString))()({
    reflectSymbol: function () {
        return "lexicon";
    }
})(Data_Eq.eqString))()({
    reflectSymbol: function () {
        return "id";
    }
})(Domain_Types.eqTournamentId))()({
    reflectSymbol: function () {
        return "dataUrl";
    }
})(Data_Eq.eqString))()({
    reflectSymbol: function () {
        return "city";
    }
})(Data_Eq.eqString))));
var map = /* #__PURE__ */ Data_Functor.map(Data_Functor.functorArray);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var NavigateToTournament = /* #__PURE__ */ (function () {
    function NavigateToTournament(value0) {
        this.value0 = value0;
    };
    NavigateToTournament.create = function (value0) {
        return new NavigateToTournament(value0);
    };
    return NavigateToTournament;
})();
var NavigateToAddTournament = /* #__PURE__ */ (function () {
    function NavigateToAddTournament() {

    };
    NavigateToAddTournament.value = new NavigateToAddTournament();
    return NavigateToAddTournament;
})();
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var LoadTournaments = /* #__PURE__ */ (function () {
    function LoadTournaments() {

    };
    LoadTournaments.value = new LoadTournaments();
    return LoadTournaments;
})();
var TournamentClick = /* #__PURE__ */ (function () {
    function TournamentClick(value0) {
        this.value0 = value0;
    };
    TournamentClick.create = function (value0) {
        return new TournamentClick(value0);
    };
    return TournamentClick;
})();
var AddTournamentClick = /* #__PURE__ */ (function () {
    function AddTournamentClick() {

    };
    AddTournamentClick.value = new AddTournamentClick();
    return AddTournamentClick;
})();
var renderTournament = function (theme) {
    return function (tournament) {
        var unwrapTournamentId = function (v) {
            return v;
        };
        return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.P_4.value), Utils_CSS.cls(CSS_Class.Mb_4.value), Utils_CSS.thm(theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.thm(theme)(CSS_ThemeColor.SecondaryBorder.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.thm(theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.CursorPointer.value), Utils_CSS.cls(CSS_Class.TransitionColors.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.thm(theme)(CSS_ThemeColor.ShadowColor.value) ]), Halogen_HTML_Events.onClick(function (v) {
            return new TournamentClick(unwrapTournamentId(tournament.id));
        }) ])([ Halogen_HTML_Elements.h3([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.FontSemibold.value), Utils_CSS.cls(CSS_Class.Text_Lg.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text(tournament.name) ]), Halogen_HTML_Elements.p([ Utils_CSS.css([ Utils_CSS.thm(theme)(CSS_ThemeColor.TextSecondary.value) ]) ])([ Halogen_HTML_Core.text(tournament.city + (", " + (show(tournament.year) + (" - " + tournament.lexicon)))) ]) ]);
    };
};
var render = function (state) {
    return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.MinHScreen.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PageBackground.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.PageContainer.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mb_6.value), Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.Gap_4.value) ]) ])([ Halogen_HTML_Elements.button([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Px_6.value), Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.RoundedMd.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.TransitionColors.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.ShadowColor.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value) ]) ])([ Halogen_HTML_Core.text("View All Tournaments") ]), Halogen_HTML_Elements.button([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Px_6.value), Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.RoundedMd.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.TransitionColors.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.ShadowColor.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value) ]), Halogen_HTML_Events.onClick(function (v) {
        return AddTournamentClick.value;
    }) ])([ Halogen_HTML_Core.text("Add New Tournament") ]) ]), Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.cls(CSS_Class.P_6.value) ]) ])([ Halogen_HTML_Elements.h2([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.PageTitle.value), Utils_CSS.cls(CSS_Class.Mb_6.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Tournaments") ]), (function () {
        if (state.loading) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextSecondary.value) ]) ])([ Halogen_HTML_Core.text("Loading tournaments...") ]);
        };
        if (state.error instanceof Data_Maybe.Just) {
            return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.TextRed600.value) ]) ])([ Halogen_HTML_Core.text(state.error.value0) ]);
        };
        if (state.error instanceof Data_Maybe.Nothing) {
            var $79 = eq(state.tournaments)([  ]);
            if ($79) {
                return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextSecondary.value) ]) ])([ Halogen_HTML_Core.text("No tournaments found.") ]);
            };
            return Halogen_HTML_Elements.div_(map(renderTournament(state.theme))(state.tournaments));
        };
        throw new Error("Failed pattern match at Component.TournamentManagerPage (line 89, column 24 - line 102, column 77): " + [ state.error.constructor.name ]);
    })() ]) ]) ]);
};
var initialState = function (v) {
    return {
        tournaments: [  ],
        loading: true,
        error: Data_Maybe.Nothing.value,
        theme: Config_Themes.getTheme("scrabble")
    };
};
var handleAction = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var listTournaments = Backend_MonadBackend.listTournaments(dictMonadBackend);
    return function (dictMonadEffect) {
        return function (v) {
            if (v instanceof Initialize) {
                return handleAction(dictMonadBackend)(dictMonadEffect)(LoadTournaments.value);
            };
            if (v instanceof LoadTournaments) {
                return withLoading(listTournaments)(function (tournaments) {
                    return modify_(function (v1) {
                        var $81 = {};
                        for (var $82 in v1) {
                            if ({}.hasOwnProperty.call(v1, $82)) {
                                $81[$82] = v1[$82];
                            };
                        };
                        $81.tournaments = tournaments;
                        return $81;
                    });
                });
            };
            if (v instanceof TournamentClick) {
                return Halogen_Query_HalogenM.raise(new NavigateToTournament(v.value0));
            };
            if (v instanceof AddTournamentClick) {
                return Halogen_Query_HalogenM.raise(NavigateToAddTournament.value);
            };
            throw new Error("Failed pattern match at Component.TournamentManagerPage (line 124, column 16 - line 136, column 36): " + [ v.constructor.name ]);
        };
    };
};
var component = function (dictMonadBackend) {
    var handleAction1 = handleAction(dictMonadBackend);
    return function (dictMonadEffect) {
        return Halogen_Component.mkComponent({
            initialState: initialState,
            render: render,
            "eval": Halogen_Component.mkEval({
                handleQuery: Halogen_Component.defaultEval.handleQuery,
                receive: Halogen_Component.defaultEval.receive,
                finalize: Halogen_Component.defaultEval.finalize,
                handleAction: handleAction1(dictMonadEffect),
                initialize: new Data_Maybe.Just(Initialize.value)
            })
        });
    };
};
export {
    Initialize,
    LoadTournaments,
    TournamentClick,
    AddTournamentClick,
    NavigateToTournament,
    NavigateToAddTournament,
    component,
    initialState,
    render,
    renderTournament,
    handleAction
};
