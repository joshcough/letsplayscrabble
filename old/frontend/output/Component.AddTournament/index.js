// Generated by purs version 0.15.15
import * as Backend_MonadBackend from "../Backend.MonadBackend/index.js";
import * as CSS_Class from "../CSS.Class/index.js";
import * as CSS_ThemeColor from "../CSS.ThemeColor/index.js";
import * as Component_ThemeSelector from "../Component.ThemeSelector/index.js";
import * as Config_Themes from "../Config.Themes/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Control_Monad_State_Class from "../Control.Monad.State.Class/index.js";
import * as DOM_HTML_Indexed_ButtonType from "../DOM.HTML.Indexed.ButtonType/index.js";
import * as DOM_HTML_Indexed_InputType from "../DOM.HTML.Indexed.InputType/index.js";
import * as Data_Function from "../Data.Function/index.js";
import * as Data_Int from "../Data.Int/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Halogen_Component from "../Halogen.Component/index.js";
import * as Halogen_HTML_Core from "../Halogen.HTML.Core/index.js";
import * as Halogen_HTML_Elements from "../Halogen.HTML.Elements/index.js";
import * as Halogen_HTML_Events from "../Halogen.HTML.Events/index.js";
import * as Halogen_HTML_Properties from "../Halogen.HTML.Properties/index.js";
import * as Halogen_Query_HalogenM from "../Halogen.Query.HalogenM/index.js";
import * as Utils_Auth from "../Utils.Auth/index.js";
import * as Utils_CSS from "../Utils.CSS/index.js";
import * as Utils_Halogen from "../Utils.Halogen/index.js";
import * as Web_Event_Event from "../Web.Event.Event/index.js";
var type_ = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropInputType);
var value = /* #__PURE__ */ Halogen_HTML_Properties.value(Halogen_HTML_Core.isPropString);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var type_1 = /* #__PURE__ */ Halogen_HTML_Properties.type_(Halogen_HTML_Core.isPropButtonType);
var bind = /* #__PURE__ */ Control_Bind.bind(Halogen_Query_HalogenM.bindHalogenM);
var get = /* #__PURE__ */ Control_Monad_State_Class.get(Halogen_Query_HalogenM.monadStateHalogenM);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Halogen_Query_HalogenM.bindHalogenM);
var modify_ = /* #__PURE__ */ Control_Monad_State_Class.modify_(Halogen_Query_HalogenM.monadStateHalogenM);
var when = /* #__PURE__ */ Control_Applicative.when(Halogen_Query_HalogenM.applicativeHalogenM);
var Initialize = /* #__PURE__ */ (function () {
    function Initialize() {

    };
    Initialize.value = new Initialize();
    return Initialize;
})();
var UpdateName = /* #__PURE__ */ (function () {
    function UpdateName(value0) {
        this.value0 = value0;
    };
    UpdateName.create = function (value0) {
        return new UpdateName(value0);
    };
    return UpdateName;
})();
var UpdateCity = /* #__PURE__ */ (function () {
    function UpdateCity(value0) {
        this.value0 = value0;
    };
    UpdateCity.create = function (value0) {
        return new UpdateCity(value0);
    };
    return UpdateCity;
})();
var UpdateYear = /* #__PURE__ */ (function () {
    function UpdateYear(value0) {
        this.value0 = value0;
    };
    UpdateYear.create = function (value0) {
        return new UpdateYear(value0);
    };
    return UpdateYear;
})();
var UpdateLexicon = /* #__PURE__ */ (function () {
    function UpdateLexicon(value0) {
        this.value0 = value0;
    };
    UpdateLexicon.create = function (value0) {
        return new UpdateLexicon(value0);
    };
    return UpdateLexicon;
})();
var UpdateLongFormName = /* #__PURE__ */ (function () {
    function UpdateLongFormName(value0) {
        this.value0 = value0;
    };
    UpdateLongFormName.create = function (value0) {
        return new UpdateLongFormName(value0);
    };
    return UpdateLongFormName;
})();
var UpdateDataUrl = /* #__PURE__ */ (function () {
    function UpdateDataUrl(value0) {
        this.value0 = value0;
    };
    UpdateDataUrl.create = function (value0) {
        return new UpdateDataUrl(value0);
    };
    return UpdateDataUrl;
})();
var SelectTheme = /* #__PURE__ */ (function () {
    function SelectTheme(value0) {
        this.value0 = value0;
    };
    SelectTheme.create = function (value0) {
        return new SelectTheme(value0);
    };
    return SelectTheme;
})();
var Submit = /* #__PURE__ */ (function () {
    function Submit(value0) {
        this.value0 = value0;
    };
    Submit.create = function (value0) {
        return new Submit(value0);
    };
    return Submit;
})();
var renderNumberField = function (label) {
    return function (fieldId) {
        return function (value1) {
            return function (updateAction) {
                return function (theme) {
                    return function (disabled) {
                        return Halogen_HTML_Elements.div_([ Halogen_HTML_Elements.label([ Halogen_HTML_Properties["for"](fieldId), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Block.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FontMedium.value), Utils_CSS.cls(CSS_Class.Mb_1.value) ]) ])([ Halogen_HTML_Core.text(label) ]), Halogen_HTML_Elements.input([ type_(DOM_HTML_Indexed_InputType.InputNumber.value), Halogen_HTML_Properties.id(fieldId), value(show(value1)), Halogen_HTML_Events.onValueInput(updateAction), Halogen_HTML_Properties.required(true), Halogen_HTML_Properties.disabled(disabled), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.P_2.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(theme)(CSS_ThemeColor.SecondaryBorder.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.thm(theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FocusRing_2.value), Utils_CSS.cls(CSS_Class.FocusRingBlue_500.value), Utils_CSS.cls(CSS_Class.OutlineNone.value), Utils_CSS.cls(CSS_Class.TransitionColors.value) ]) ]) ]);
                    };
                };
            };
        };
    };
};
var renderInputField = function (label) {
    return function (fieldId) {
        return function (value1) {
            return function (updateAction) {
                return function (theme) {
                    return function (disabled) {
                        return Halogen_HTML_Elements.div_([ Halogen_HTML_Elements.label([ Halogen_HTML_Properties["for"](fieldId), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Block.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FontMedium.value), Utils_CSS.cls(CSS_Class.Mb_1.value) ]) ])([ Halogen_HTML_Core.text(label) ]), Halogen_HTML_Elements.input([ type_(DOM_HTML_Indexed_InputType.InputText.value), Halogen_HTML_Properties.id(fieldId), value(value1), Halogen_HTML_Events.onValueInput(updateAction), Halogen_HTML_Properties.required(true), Halogen_HTML_Properties.disabled(disabled), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.cls(CSS_Class.P_2.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(theme)(CSS_ThemeColor.SecondaryBorder.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.thm(theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.FocusRing_2.value), Utils_CSS.cls(CSS_Class.FocusRingBlue_500.value), Utils_CSS.cls(CSS_Class.OutlineNone.value), Utils_CSS.cls(CSS_Class.TransitionColors.value) ]) ]) ]);
                    };
                };
            };
        };
    };
};
var renderFeedback = function (state) {
    return function (_theme) {
        return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Mb_4.value) ]) ])([ (function () {
            if (state.error instanceof Data_Maybe.Just) {
                return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.BgRed_100.value), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.cls(CSS_Class.BorderRed_400.value), Utils_CSS.cls(CSS_Class.TextRed700.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.Rounded.value) ]) ])([ Halogen_HTML_Core.text(state.error.value0) ]);
            };
            if (state.error instanceof Data_Maybe.Nothing) {
                return Halogen_HTML_Core.text("");
            };
            throw new Error("Failed pattern match at Component.AddTournament (line 178, column 7 - line 183, column 30): " + [ state.error.constructor.name ]);
        })(), (function () {
            if (state.success instanceof Data_Maybe.Just) {
                return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.BgGreen_100.value), Utils_CSS.cls(CSS_Class.Border.value), Utils_CSS.cls(CSS_Class.BorderGreen_400.value), Utils_CSS.cls(CSS_Class.TextGreen700.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Py_3.value), Utils_CSS.cls(CSS_Class.Rounded.value) ]) ])([ Halogen_HTML_Core.text(state.success.value0) ]);
            };
            if (state.success instanceof Data_Maybe.Nothing) {
                return Halogen_HTML_Core.text("");
            };
            throw new Error("Failed pattern match at Component.AddTournament (line 184, column 7 - line 189, column 30): " + [ state.success.constructor.name ]);
        })() ]);
    };
};
var render = function (state) {
    return Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.cls(CSS_Class.P_6.value), Utils_CSS.cls(CSS_Class.RoundedLg.value), Utils_CSS.cls(CSS_Class.ShadowMd.value) ]) ])([ Halogen_HTML_Elements.div([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.Flex.value), Utils_CSS.cls(CSS_Class.JustifyBetween.value), Utils_CSS.cls(CSS_Class.ItemsCenter.value), Utils_CSS.cls(CSS_Class.Mb_6.value) ]) ])([ Halogen_HTML_Elements.h2([ Utils_CSS.css([ Utils_CSS.cls(CSS_Class.PageTitle.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value) ]) ])([ Halogen_HTML_Core.text("Add New Tournament") ]) ]), renderFeedback(state)(state.theme), Halogen_HTML_Elements.form([ Halogen_HTML_Events.onSubmit(Submit.create), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.SpaceY_6.value) ]) ])([ renderInputField("Name")("name")(state.formData.name)(UpdateName.create)(state.theme)(state.loading), renderInputField("City")("city")(state.formData.city)(UpdateCity.create)(state.theme)(state.loading), renderNumberField("Year")("year")(state.formData.year)(UpdateYear.create)(state.theme)(state.loading), renderInputField("Lexicon")("lexicon")(state.formData.lexicon)(UpdateLexicon.create)(state.theme)(state.loading), renderInputField("Display Name")("longFormName")(state.formData.longFormName)(UpdateLongFormName.create)(state.theme)(state.loading), renderInputField("Data URL")("dataUrl")(state.formData.dataUrl)(UpdateDataUrl.create)(state.theme)(state.loading), Component_ThemeSelector.renderThemeSelector(state.formData.theme)(state.theme)(SelectTheme.create), Halogen_HTML_Elements.button([ type_1(DOM_HTML_Indexed_ButtonType.ButtonSubmit.value), Halogen_HTML_Properties.disabled(state.loading), Utils_CSS.css([ Utils_CSS.cls(CSS_Class.W_Full.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.CardBackground.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.TextPrimary.value), Utils_CSS.cls(CSS_Class.Py_2.value), Utils_CSS.cls(CSS_Class.Px_4.value), Utils_CSS.cls(CSS_Class.Rounded.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.HoverBackground.value), Utils_CSS.cls(CSS_Class.TransitionColors.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.ShadowColor.value), Utils_CSS.cls(CSS_Class.ShadowMd.value), Utils_CSS.cls(CSS_Class.Border_2.value), Utils_CSS.thm(state.theme)(CSS_ThemeColor.PrimaryBorder.value), Utils_CSS.cls(CSS_Class.Mt_6.value), Utils_CSS.cls(CSS_Class.DisabledOpacity_50.value), Utils_CSS.cls(CSS_Class.DisabledCursorNotAllowed.value) ]) ])([ Halogen_HTML_Core.text((function () {
        if (state.loading) {
            return "Adding Tournament...";
        };
        return "Add Tournament";
    })()) ]) ]) ]);
};
var initialState = /* #__PURE__ */ (function () {
    return {
        formData: {
            name: "",
            city: "",
            year: 2025,
            lexicon: "",
            longFormName: "",
            dataUrl: "",
            theme: "scrabble"
        },
        loading: false,
        error: Data_Maybe.Nothing.value,
        success: Data_Maybe.Nothing.value,
        theme: Config_Themes.scrabbleTheme
    };
})();
var handleSubmitTournament = function (dictMonadBackend) {
    var withLoading = Utils_Halogen.withLoading(dictMonadBackend.MonadError0());
    var createTournament = Backend_MonadBackend.createTournament(dictMonadBackend);
    return bind(get)(function (state) {
        return discard(modify_(function (v) {
            var $49 = {};
            for (var $50 in v) {
                if ({}.hasOwnProperty.call(v, $50)) {
                    $49[$50] = v[$50];
                };
            };
            $49.success = Data_Maybe.Nothing.value;
            return $49;
        }))(function () {
            return withLoading(createTournament(state.formData))(function (v) {
                return modify_(function (v1) {
                    var $52 = {};
                    for (var $53 in v1) {
                        if ({}.hasOwnProperty.call(v1, $53)) {
                            $52[$53] = v1[$53];
                        };
                    };
                    $52.success = new Data_Maybe.Just("Tournament created successfully!");
                    $52.formData = initialState.formData;
                    return $52;
                });
            });
        });
    });
};
var handleAction = function (dictMonadBackend) {
    var handleSubmitTournament1 = handleSubmitTournament(dictMonadBackend);
    return function (dictMonadEffect) {
        var liftEffect = Effect_Class.liftEffect(Halogen_Query_HalogenM.monadEffectHalogenM(dictMonadEffect));
        return function (v) {
            if (v instanceof Initialize) {
                return bind(liftEffect(Utils_Auth.isAuthenticated))(function (authenticated) {
                    return when(!authenticated)(modify_(function (v1) {
                        var $56 = {};
                        for (var $57 in v1) {
                            if ({}.hasOwnProperty.call(v1, $57)) {
                                $56[$57] = v1[$57];
                            };
                        };
                        $56.error = new Data_Maybe.Just("Please log in to add tournaments");
                        return $56;
                    }));
                });
            };
            if (v instanceof UpdateName) {
                return modify_(function (st) {
                    var $62 = {};
                    for (var $63 in st) {
                        if ({}.hasOwnProperty.call(st, $63)) {
                            $62[$63] = st[$63];
                        };
                    };
                    $62.formData = (function () {
                        var $59 = {};
                        for (var $60 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $60)) {
                                $59[$60] = st["formData"][$60];
                            };
                        };
                        $59.name = v.value0;
                        return $59;
                    })();
                    return $62;
                });
            };
            if (v instanceof UpdateCity) {
                return modify_(function (st) {
                    var $69 = {};
                    for (var $70 in st) {
                        if ({}.hasOwnProperty.call(st, $70)) {
                            $69[$70] = st[$70];
                        };
                    };
                    $69.formData = (function () {
                        var $66 = {};
                        for (var $67 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $67)) {
                                $66[$67] = st["formData"][$67];
                            };
                        };
                        $66.city = v.value0;
                        return $66;
                    })();
                    return $69;
                });
            };
            if (v instanceof UpdateYear) {
                var year = Data_Maybe.fromMaybe(2025)(Data_Int.fromString(v.value0));
                return modify_(function (st) {
                    var $76 = {};
                    for (var $77 in st) {
                        if ({}.hasOwnProperty.call(st, $77)) {
                            $76[$77] = st[$77];
                        };
                    };
                    $76.formData = (function () {
                        var $73 = {};
                        for (var $74 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $74)) {
                                $73[$74] = st["formData"][$74];
                            };
                        };
                        $73.year = year;
                        return $73;
                    })();
                    return $76;
                });
            };
            if (v instanceof UpdateLexicon) {
                return modify_(function (st) {
                    var $83 = {};
                    for (var $84 in st) {
                        if ({}.hasOwnProperty.call(st, $84)) {
                            $83[$84] = st[$84];
                        };
                    };
                    $83.formData = (function () {
                        var $80 = {};
                        for (var $81 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $81)) {
                                $80[$81] = st["formData"][$81];
                            };
                        };
                        $80.lexicon = v.value0;
                        return $80;
                    })();
                    return $83;
                });
            };
            if (v instanceof UpdateLongFormName) {
                return modify_(function (st) {
                    var $90 = {};
                    for (var $91 in st) {
                        if ({}.hasOwnProperty.call(st, $91)) {
                            $90[$91] = st[$91];
                        };
                    };
                    $90.formData = (function () {
                        var $87 = {};
                        for (var $88 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $88)) {
                                $87[$88] = st["formData"][$88];
                            };
                        };
                        $87.longFormName = v.value0;
                        return $87;
                    })();
                    return $90;
                });
            };
            if (v instanceof UpdateDataUrl) {
                return modify_(function (st) {
                    var $97 = {};
                    for (var $98 in st) {
                        if ({}.hasOwnProperty.call(st, $98)) {
                            $97[$98] = st[$98];
                        };
                    };
                    $97.formData = (function () {
                        var $94 = {};
                        for (var $95 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $95)) {
                                $94[$95] = st["formData"][$95];
                            };
                        };
                        $94.dataUrl = v.value0;
                        return $94;
                    })();
                    return $97;
                });
            };
            if (v instanceof SelectTheme) {
                return modify_(function (st) {
                    var $104 = {};
                    for (var $105 in st) {
                        if ({}.hasOwnProperty.call(st, $105)) {
                            $104[$105] = st[$105];
                        };
                    };
                    $104.formData = (function () {
                        var $101 = {};
                        for (var $102 in st.formData) {
                            if ({}.hasOwnProperty.call(st.formData, $102)) {
                                $101[$102] = st["formData"][$102];
                            };
                        };
                        $101.theme = v.value0;
                        return $101;
                    })();
                    return $104;
                });
            };
            if (v instanceof Submit) {
                return discard(liftEffect(Web_Event_Event.preventDefault(v.value0)))(function () {
                    return handleSubmitTournament1;
                });
            };
            throw new Error("Failed pattern match at Component.AddTournament (line 87, column 16 - line 117, column 27): " + [ v.constructor.name ]);
        };
    };
};
var component = function (dictMonadBackend) {
    var handleAction1 = handleAction(dictMonadBackend);
    return function (dictMonadEffect) {
        return Halogen_Component.mkComponent({
            initialState: Data_Function["const"](initialState),
            render: render,
            "eval": Halogen_Component.mkEval({
                handleQuery: Halogen_Component.defaultEval.handleQuery,
                receive: Halogen_Component.defaultEval.receive,
                finalize: Halogen_Component.defaultEval.finalize,
                handleAction: handleAction1(dictMonadEffect),
                initialize: new Data_Maybe.Just(Initialize.value)
            })
        });
    };
};
export {
    Initialize,
    UpdateName,
    UpdateCity,
    UpdateYear,
    UpdateLexicon,
    UpdateLongFormName,
    UpdateDataUrl,
    SelectTheme,
    Submit,
    component,
    initialState,
    handleAction,
    handleSubmitTournament,
    render,
    renderFeedback,
    renderInputField,
    renderNumberField
};
