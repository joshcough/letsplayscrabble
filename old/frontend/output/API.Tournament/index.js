// Generated by purs version 0.15.15
import * as Affjax from "../Affjax/index.js";
import * as Affjax_RequestBody from "../Affjax.RequestBody/index.js";
import * as Affjax_RequestHeader from "../Affjax.RequestHeader/index.js";
import * as Affjax_ResponseFormat from "../Affjax.ResponseFormat/index.js";
import * as Affjax_Web from "../Affjax.Web/index.js";
import * as Control_Applicative from "../Control.Applicative/index.js";
import * as Control_Bind from "../Control.Bind/index.js";
import * as Data_Argonaut_Core from "../Data.Argonaut.Core/index.js";
import * as Data_Argonaut_Decode_Class from "../Data.Argonaut.Decode.Class/index.js";
import * as Data_Argonaut_Decode_Combinators from "../Data.Argonaut.Decode.Combinators/index.js";
import * as Data_Argonaut_Decode_Error from "../Data.Argonaut.Decode.Error/index.js";
import * as Data_Argonaut_Encode_Class from "../Data.Argonaut.Encode.Class/index.js";
import * as Data_Argonaut_Encode_Combinators from "../Data.Argonaut.Encode.Combinators/index.js";
import * as Data_Bifunctor from "../Data.Bifunctor/index.js";
import * as Data_Either from "../Data.Either/index.js";
import * as Data_Functor from "../Data.Functor/index.js";
import * as Data_HTTP_Method from "../Data.HTTP.Method/index.js";
import * as Data_Maybe from "../Data.Maybe/index.js";
import * as Data_Show from "../Data.Show/index.js";
import * as Data_Traversable from "../Data.Traversable/index.js";
import * as Data_Unit from "../Data.Unit/index.js";
import * as Domain_Types from "../Domain.Types/index.js";
import * as Effect_Aff from "../Effect.Aff/index.js";
import * as Effect_Class from "../Effect.Class/index.js";
import * as Utils_Auth from "../Utils.Auth/index.js";
import * as Utils_Logger from "../Utils.Logger/index.js";
var bind = /* #__PURE__ */ Control_Bind.bind(Effect_Aff.bindAff);
var liftEffect = /* #__PURE__ */ Effect_Class.liftEffect(Effect_Aff.monadEffectAff);
var pure = /* #__PURE__ */ Control_Applicative.pure(Effect_Aff.applicativeAff);
var show = /* #__PURE__ */ Data_Show.show(Data_Show.showInt);
var decodeForeignObject = /* #__PURE__ */ Data_Argonaut_Decode_Class.decodeForeignObject(Data_Argonaut_Decode_Class.decodeJsonJson);
var decodeJson = /* #__PURE__ */ Data_Argonaut_Decode_Class.decodeJson(decodeForeignObject);
var getField = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(Data_Argonaut_Decode_Class.decodeJsonBoolean);
var getField1 = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(Data_Argonaut_Decode_Class.decodeJsonString);
var getField2 = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(decodeForeignObject);
var extend = /* #__PURE__ */ Data_Argonaut_Encode_Combinators.extend(Data_Argonaut_Encode_Class.encodeJsonJson);
var assoc = /* #__PURE__ */ Data_Argonaut_Encode_Combinators.assoc(Data_Argonaut_Encode_Class.encodeJsonInt);
var encodeJson = /* #__PURE__ */ Data_Argonaut_Encode_Class.encodeJson(/* #__PURE__ */ Data_Argonaut_Encode_Class.encodeRecord(Data_Argonaut_Encode_Class.gEncodeJsonNil)());
var bind1 = /* #__PURE__ */ Control_Bind.bind(Data_Either.bindEither);
var lmap = /* #__PURE__ */ Data_Bifunctor.lmap(Data_Bifunctor.bifunctorEither);
var map = /* #__PURE__ */ Data_Functor.map(Data_Either.functorEither);
var getField3 = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(Data_Argonaut_Decode_Class.decodeJsonInt);
var getFieldOptional$prime = /* #__PURE__ */ Data_Argonaut_Decode_Combinators["getFieldOptional$prime"](Data_Argonaut_Decode_Class.decodeJsonString);
var pure1 = /* #__PURE__ */ Control_Applicative.pure(Data_Either.applicativeEither);
var getField4 = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(/* #__PURE__ */ Data_Argonaut_Decode_Class.decodeArray(Data_Argonaut_Decode_Class.decodeJsonJson));
var traverse = /* #__PURE__ */ Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither);
var getField5 = /* #__PURE__ */ Data_Argonaut_Decode_Combinators.getField(Data_Argonaut_Decode_Class.decodeJsonJson);
var assoc1 = /* #__PURE__ */ Data_Argonaut_Encode_Combinators.assoc(Data_Argonaut_Encode_Class.encodeJsonJString);
var discard = /* #__PURE__ */ Control_Bind.discard(Control_Bind.discardUnit)(Effect_Aff.bindAff);
var stopPolling = function (tournamentId) {
    return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
        if (maybeToken instanceof Data_Maybe.Nothing) {
            return pure(new Data_Either.Left("Not authenticated"));
        };
        if (maybeToken instanceof Data_Maybe.Just) {
            var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0) ];
            var url = "http://localhost:3001/api/private/tournaments/" + (show(tournamentId) + "/polling");
            return bind(Affjax_Web.request({
                content: Affjax.defaultRequest.content,
                username: Affjax.defaultRequest.username,
                password: Affjax.defaultRequest.password,
                withCredentials: Affjax.defaultRequest.withCredentials,
                timeout: Affjax.defaultRequest.timeout,
                url: url,
                method: new Data_Either.Left(Data_HTTP_Method.DELETE.value),
                headers: headers,
                responseFormat: Affjax_ResponseFormat.json
            }))(function (result) {
                if (result instanceof Data_Either.Left) {
                    return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                };
                if (result instanceof Data_Either.Right) {
                    return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                        if (obj instanceof Data_Either.Left) {
                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                        };
                        if (obj instanceof Data_Either.Right) {
                            return bind(pure(getField(obj.value0)("success")))(function (success) {
                                if (success instanceof Data_Either.Left) {
                                    return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                                };
                                if (success instanceof Data_Either.Right && !success.value0) {
                                    return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                        if (error instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left("Failed to stop polling"));
                                        };
                                        if (error instanceof Data_Either.Right) {
                                            return pure(new Data_Either.Left(error.value0));
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 280, column 19 - line 282, column 55): " + [ error.constructor.name ]);
                                    });
                                };
                                if (success instanceof Data_Either.Right && success.value0) {
                                    return pure(new Data_Either.Right(Data_Unit.unit));
                                };
                                throw new Error("Failed pattern match at API.Tournament (line 276, column 15 - line 283, column 48): " + [ success.constructor.name ]);
                            });
                        };
                        throw new Error("Failed pattern match at API.Tournament (line 272, column 11 - line 283, column 48): " + [ obj.constructor.name ]);
                    });
                };
                throw new Error("Failed pattern match at API.Tournament (line 268, column 7 - line 283, column 48): " + [ result.constructor.name ]);
            });
        };
        throw new Error("Failed pattern match at API.Tournament (line 256, column 3 - line 283, column 48): " + [ maybeToken.constructor.name ]);
    });
};
var refetchTournament = function (tournamentId) {
    return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
        if (maybeToken instanceof Data_Maybe.Nothing) {
            return pure(new Data_Either.Left("Not authenticated"));
        };
        if (maybeToken instanceof Data_Maybe.Just) {
            var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0) ];
            var url = "http://localhost:3001/api/private/tournaments/" + (show(tournamentId) + "/refetch");
            return bind(Affjax_Web.request({
                content: Affjax.defaultRequest.content,
                username: Affjax.defaultRequest.username,
                password: Affjax.defaultRequest.password,
                withCredentials: Affjax.defaultRequest.withCredentials,
                timeout: Affjax.defaultRequest.timeout,
                url: url,
                method: new Data_Either.Left(Data_HTTP_Method.POST.value),
                headers: headers,
                responseFormat: Affjax_ResponseFormat.json
            }))(function (result) {
                if (result instanceof Data_Either.Left) {
                    return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                };
                if (result instanceof Data_Either.Right) {
                    return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                        if (obj instanceof Data_Either.Left) {
                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                        };
                        if (obj instanceof Data_Either.Right) {
                            return bind(pure(getField(obj.value0)("success")))(function (success) {
                                if (success instanceof Data_Either.Left) {
                                    return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                                };
                                if (success instanceof Data_Either.Right && !success.value0) {
                                    return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                        if (error instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left("Refetch failed"));
                                        };
                                        if (error instanceof Data_Either.Right) {
                                            return pure(new Data_Either.Left(error.value0));
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 346, column 19 - line 348, column 55): " + [ error.constructor.name ]);
                                    });
                                };
                                if (success instanceof Data_Either.Right && success.value0) {
                                    return bind(pure(getField2(obj.value0)("data")))(function (dataObj) {
                                        if (dataObj instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(dataObj.value0)));
                                        };
                                        if (dataObj instanceof Data_Either.Right) {
                                            return bind(pure(getField1(dataObj.value0)("message")))(function (message) {
                                                if (message instanceof Data_Either.Left) {
                                                    return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(message.value0)));
                                                };
                                                if (message instanceof Data_Either.Right) {
                                                    return pure(new Data_Either.Right(message.value0));
                                                };
                                                throw new Error("Failed pattern match at API.Tournament (line 355, column 23 - line 357, column 54): " + [ message.constructor.name ]);
                                            });
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 351, column 19 - line 357, column 54): " + [ dataObj.constructor.name ]);
                                    });
                                };
                                throw new Error("Failed pattern match at API.Tournament (line 342, column 15 - line 357, column 54): " + [ success.constructor.name ]);
                            });
                        };
                        throw new Error("Failed pattern match at API.Tournament (line 338, column 11 - line 357, column 54): " + [ obj.constructor.name ]);
                    });
                };
                throw new Error("Failed pattern match at API.Tournament (line 334, column 7 - line 357, column 54): " + [ result.constructor.name ]);
            });
        };
        throw new Error("Failed pattern match at API.Tournament (line 322, column 3 - line 357, column 54): " + [ maybeToken.constructor.name ]);
    });
};
var fullRefetchTournament = function (tournamentId) {
    return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
        if (maybeToken instanceof Data_Maybe.Nothing) {
            return pure(new Data_Either.Left("Not authenticated"));
        };
        if (maybeToken instanceof Data_Maybe.Just) {
            var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0) ];
            var url = "http://localhost:3001/api/private/tournaments/" + (show(tournamentId) + "/full-refetch");
            return bind(Affjax_Web.request({
                content: Affjax.defaultRequest.content,
                username: Affjax.defaultRequest.username,
                password: Affjax.defaultRequest.password,
                withCredentials: Affjax.defaultRequest.withCredentials,
                timeout: Affjax.defaultRequest.timeout,
                url: url,
                method: new Data_Either.Left(Data_HTTP_Method.POST.value),
                headers: headers,
                responseFormat: Affjax_ResponseFormat.json
            }))(function (result) {
                if (result instanceof Data_Either.Left) {
                    return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                };
                if (result instanceof Data_Either.Right) {
                    return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                        if (obj instanceof Data_Either.Left) {
                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                        };
                        if (obj instanceof Data_Either.Right) {
                            return bind(pure(getField(obj.value0)("success")))(function (success) {
                                if (success instanceof Data_Either.Left) {
                                    return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                                };
                                if (success instanceof Data_Either.Right && !success.value0) {
                                    return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                        if (error instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left("Full refetch failed"));
                                        };
                                        if (error instanceof Data_Either.Right) {
                                            return pure(new Data_Either.Left(error.value0));
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 387, column 19 - line 389, column 55): " + [ error.constructor.name ]);
                                    });
                                };
                                if (success instanceof Data_Either.Right && success.value0) {
                                    return bind(pure(getField2(obj.value0)("data")))(function (dataObj) {
                                        if (dataObj instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(dataObj.value0)));
                                        };
                                        if (dataObj instanceof Data_Either.Right) {
                                            return bind(pure(getField1(dataObj.value0)("message")))(function (message) {
                                                if (message instanceof Data_Either.Left) {
                                                    return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(message.value0)));
                                                };
                                                if (message instanceof Data_Either.Right) {
                                                    return pure(new Data_Either.Right(message.value0));
                                                };
                                                throw new Error("Failed pattern match at API.Tournament (line 396, column 23 - line 398, column 54): " + [ message.constructor.name ]);
                                            });
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 392, column 19 - line 398, column 54): " + [ dataObj.constructor.name ]);
                                    });
                                };
                                throw new Error("Failed pattern match at API.Tournament (line 383, column 15 - line 398, column 54): " + [ success.constructor.name ]);
                            });
                        };
                        throw new Error("Failed pattern match at API.Tournament (line 379, column 11 - line 398, column 54): " + [ obj.constructor.name ]);
                    });
                };
                throw new Error("Failed pattern match at API.Tournament (line 375, column 7 - line 398, column 54): " + [ result.constructor.name ]);
            });
        };
        throw new Error("Failed pattern match at API.Tournament (line 363, column 3 - line 398, column 54): " + [ maybeToken.constructor.name ]);
    });
};
var enablePolling = function (tournamentId) {
    return function (days) {
        return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
            if (maybeToken instanceof Data_Maybe.Nothing) {
                return pure(new Data_Either.Left("Not authenticated"));
            };
            if (maybeToken instanceof Data_Maybe.Just) {
                var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0), new Affjax_RequestHeader.RequestHeader("Content-Type", "application/json") ];
                var url = "http://localhost:3001/api/private/tournaments/" + (show(tournamentId) + "/polling");
                var body = extend(assoc("days")(days))(encodeJson({}));
                return bind(Affjax_Web.request({
                    username: Affjax.defaultRequest.username,
                    password: Affjax.defaultRequest.password,
                    withCredentials: Affjax.defaultRequest.withCredentials,
                    timeout: Affjax.defaultRequest.timeout,
                    url: url,
                    method: new Data_Either.Left(Data_HTTP_Method.POST.value),
                    headers: headers,
                    content: new Data_Maybe.Just(Affjax_RequestBody.json(body)),
                    responseFormat: Affjax_ResponseFormat.json
                }))(function (result) {
                    if (result instanceof Data_Either.Left) {
                        return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                    };
                    if (result instanceof Data_Either.Right) {
                        return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                            if (obj instanceof Data_Either.Left) {
                                return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                            };
                            if (obj instanceof Data_Either.Right) {
                                return bind(pure(getField(obj.value0)("success")))(function (success) {
                                    if (success instanceof Data_Either.Left) {
                                        return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                                    };
                                    if (success instanceof Data_Either.Right && !success.value0) {
                                        return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                            if (error instanceof Data_Either.Left) {
                                                return pure(new Data_Either.Left("Failed to enable polling"));
                                            };
                                            if (error instanceof Data_Either.Right) {
                                                return pure(new Data_Either.Left(error.value0));
                                            };
                                            throw new Error("Failed pattern match at API.Tournament (line 239, column 19 - line 241, column 55): " + [ error.constructor.name ]);
                                        });
                                    };
                                    if (success instanceof Data_Either.Right && success.value0) {
                                        return bind(pure(getField2(obj.value0)("data")))(function (dataObj) {
                                            if (dataObj instanceof Data_Either.Left) {
                                                return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(dataObj.value0)));
                                            };
                                            if (dataObj instanceof Data_Either.Right) {
                                                return bind(pure(getField1(dataObj.value0)("pollUntil")))(function (pollUntil) {
                                                    if (pollUntil instanceof Data_Either.Left) {
                                                        return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(pollUntil.value0)));
                                                    };
                                                    if (pollUntil instanceof Data_Either.Right) {
                                                        return pure(new Data_Either.Right(pollUntil.value0));
                                                    };
                                                    throw new Error("Failed pattern match at API.Tournament (line 248, column 23 - line 250, column 62): " + [ pollUntil.constructor.name ]);
                                                });
                                            };
                                            throw new Error("Failed pattern match at API.Tournament (line 244, column 19 - line 250, column 62): " + [ dataObj.constructor.name ]);
                                        });
                                    };
                                    throw new Error("Failed pattern match at API.Tournament (line 235, column 15 - line 250, column 62): " + [ success.constructor.name ]);
                                });
                            };
                            throw new Error("Failed pattern match at API.Tournament (line 231, column 11 - line 250, column 62): " + [ obj.constructor.name ]);
                        });
                    };
                    throw new Error("Failed pattern match at API.Tournament (line 227, column 7 - line 250, column 62): " + [ result.constructor.name ]);
                });
            };
            throw new Error("Failed pattern match at API.Tournament (line 211, column 3 - line 250, column 62): " + [ maybeToken.constructor.name ]);
        });
    };
};
var decodeTournament = function (json) {
    return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(decodeJson(json)))(function (obj) {
        return bind1(map(Domain_Types.TournamentId)(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField3(obj)("id"))))(function (id) {
            return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("name")))(function (name) {
                return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("city")))(function (city) {
                    return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField3(obj)("year")))(function (year) {
                        return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("lexicon")))(function (lexicon) {
                            return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("longFormName")))(function (longFormName) {
                                return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("dataUrl")))(function (dataUrl) {
                                    return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getFieldOptional$prime(obj)("pollUntil")))(function (pollUntil) {
                                        return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("theme")))(function (theme) {
                                            return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField(obj)("transparentBackground")))(function (transparentBackground) {
                                                return pure1({
                                                    id: id,
                                                    name: name,
                                                    city: city,
                                                    year: year,
                                                    lexicon: lexicon,
                                                    longFormName: longFormName,
                                                    dataUrl: dataUrl,
                                                    pollUntil: pollUntil,
                                                    theme: theme,
                                                    transparentBackground: transparentBackground
                                                });
                                            });
                                        });
                                    });
                                });
                            });
                        });
                    });
                });
            });
        });
    });
};
var decodeTournamentListResponse = function (json) {
    return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(decodeJson(json)))(function (obj) {
        return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField(obj)("success")))(function (success) {
            if (success) {
                return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField4(obj)("data")))(function (tournamentsJson) {
                    return bind1(traverse(decodeTournament)(tournamentsJson))(function (tournaments) {
                        return pure1(tournaments);
                    });
                });
            };
            return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("error")))(function (error) {
                return new Data_Either.Left(error);
            });
        });
    });
};
var listTournaments = /* #__PURE__ */ bind(/* #__PURE__ */ liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
    if (maybeToken instanceof Data_Maybe.Nothing) {
        return pure(new Data_Either.Left("Not authenticated"));
    };
    if (maybeToken instanceof Data_Maybe.Just) {
        var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0) ];
        return bind(Affjax_Web.request({
            content: Affjax.defaultRequest.content,
            username: Affjax.defaultRequest.username,
            password: Affjax.defaultRequest.password,
            withCredentials: Affjax.defaultRequest.withCredentials,
            timeout: Affjax.defaultRequest.timeout,
            url: "http://localhost:3001/api/private/tournaments/list",
            method: new Data_Either.Left(Data_HTTP_Method.GET.value),
            headers: headers,
            responseFormat: Affjax_ResponseFormat.json
        }))(function (result) {
            if (result instanceof Data_Either.Left) {
                return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
            };
            if (result instanceof Data_Either.Right) {
                return pure(decodeTournamentListResponse(result.value0.body));
            };
            throw new Error("Failed pattern match at API.Tournament (line 114, column 7 - line 116, column 76): " + [ result.constructor.name ]);
        });
    };
    throw new Error("Failed pattern match at API.Tournament (line 102, column 3 - line 116, column 76): " + [ maybeToken.constructor.name ]);
});
var decodeTournamentRowResponse = function (json) {
    return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(decodeJson(json)))(function (obj) {
        return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField(obj)("success")))(function (success) {
            if (success) {
                return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField5(obj)("data")))(function (tournamentJson) {
                    return decodeTournament(tournamentJson);
                });
            };
            return bind1(lmap(Data_Argonaut_Decode_Error.printJsonDecodeError)(getField1(obj)("error")))(function (error) {
                return new Data_Either.Left(error);
            });
        });
    });
};
var getTournamentRow = function (userId) {
    return function (tournamentId) {
        var url = "http://localhost:3001/api/public/users/" + (show(userId) + ("/tournaments/" + (show(tournamentId) + "/row")));
        return bind(Affjax_Web.request({
            headers: Affjax.defaultRequest.headers,
            content: Affjax.defaultRequest.content,
            username: Affjax.defaultRequest.username,
            password: Affjax.defaultRequest.password,
            withCredentials: Affjax.defaultRequest.withCredentials,
            timeout: Affjax.defaultRequest.timeout,
            url: url,
            method: new Data_Either.Left(Data_HTTP_Method.GET.value),
            responseFormat: Affjax_ResponseFormat.json
        }))(function (result) {
            if (result instanceof Data_Either.Left) {
                return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
            };
            if (result instanceof Data_Either.Right) {
                return pure(decodeTournamentRowResponse(result.value0.body));
            };
            throw new Error("Failed pattern match at API.Tournament (line 140, column 3 - line 142, column 71): " + [ result.constructor.name ]);
        });
    };
};
var updateTournament = function (tournamentId) {
    return function (metadata) {
        return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
            if (maybeToken instanceof Data_Maybe.Nothing) {
                return pure(new Data_Either.Left("Not authenticated"));
            };
            if (maybeToken instanceof Data_Maybe.Just) {
                var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0), new Affjax_RequestHeader.RequestHeader("Content-Type", "application/json") ];
                var url = "http://localhost:3001/api/private/tournaments/" + show(tournamentId);
                var body = extend(assoc1("name")(metadata.name))(extend(assoc1("longFormName")(metadata.longFormName))(extend(assoc1("city")(metadata.city))(extend(assoc("year")(metadata.year))(extend(assoc1("lexicon")(metadata.lexicon))(extend(assoc1("theme")(metadata.theme))(extend(assoc1("dataUrl")(metadata.dataUrl))(encodeJson({}))))))));
                return bind(Affjax_Web.request({
                    username: Affjax.defaultRequest.username,
                    password: Affjax.defaultRequest.password,
                    withCredentials: Affjax.defaultRequest.withCredentials,
                    timeout: Affjax.defaultRequest.timeout,
                    url: url,
                    method: new Data_Either.Left(Data_HTTP_Method.PUT.value),
                    headers: headers,
                    content: new Data_Maybe.Just(Affjax_RequestBody.json(body)),
                    responseFormat: Affjax_ResponseFormat.json
                }))(function (result) {
                    if (result instanceof Data_Either.Left) {
                        return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                    };
                    if (result instanceof Data_Either.Right) {
                        return discard(liftEffect(Utils_Logger.log("[API] Update response: " + Data_Argonaut_Core.stringify(result.value0.body))))(function () {
                            return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                                if (obj instanceof Data_Either.Left) {
                                    return discard(liftEffect(Utils_Logger.log("[API] Failed to decode response object: " + Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0))))(function () {
                                        return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                                    });
                                };
                                if (obj instanceof Data_Either.Right) {
                                    return bind(pure(getField(obj.value0)("success")))(function (success) {
                                        if (success instanceof Data_Either.Left) {
                                            return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                                        };
                                        if (success instanceof Data_Either.Right && !success.value0) {
                                            return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                                if (error instanceof Data_Either.Left) {
                                                    return pure(new Data_Either.Left("Update failed"));
                                                };
                                                if (error instanceof Data_Either.Right) {
                                                    return pure(new Data_Either.Left(error.value0));
                                                };
                                                throw new Error("Failed pattern match at API.Tournament (line 190, column 19 - line 192, column 55): " + [ error.constructor.name ]);
                                            });
                                        };
                                        if (success instanceof Data_Either.Right && success.value0) {
                                            return bind(pure(getField2(obj.value0)("data")))(function (dataObj) {
                                                if (dataObj instanceof Data_Either.Left) {
                                                    return discard(liftEffect(Utils_Logger.log("[API] Failed to decode data object: " + Data_Argonaut_Decode_Error.printJsonDecodeError(dataObj.value0))))(function () {
                                                        return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(dataObj.value0)));
                                                    });
                                                };
                                                if (dataObj instanceof Data_Either.Right) {
                                                    return bind(pure(getField5(dataObj.value0)("tournament")))(function (tournamentJson) {
                                                        if (tournamentJson instanceof Data_Either.Left) {
                                                            return discard(liftEffect(Utils_Logger.log("[API] Failed to decode tournament: " + Data_Argonaut_Decode_Error.printJsonDecodeError(tournamentJson.value0))))(function () {
                                                                return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(tournamentJson.value0)));
                                                            });
                                                        };
                                                        if (tournamentJson instanceof Data_Either.Right) {
                                                            return pure(decodeTournament(tournamentJson.value0));
                                                        };
                                                        throw new Error("Failed pattern match at API.Tournament (line 201, column 23 - line 205, column 61): " + [ tournamentJson.constructor.name ]);
                                                    });
                                                };
                                                throw new Error("Failed pattern match at API.Tournament (line 195, column 19 - line 205, column 61): " + [ dataObj.constructor.name ]);
                                            });
                                        };
                                        throw new Error("Failed pattern match at API.Tournament (line 186, column 15 - line 205, column 61): " + [ success.constructor.name ]);
                                    });
                                };
                                throw new Error("Failed pattern match at API.Tournament (line 180, column 11 - line 205, column 61): " + [ obj.constructor.name ]);
                            });
                        });
                    };
                    throw new Error("Failed pattern match at API.Tournament (line 172, column 7 - line 205, column 61): " + [ result.constructor.name ]);
                });
            };
            throw new Error("Failed pattern match at API.Tournament (line 148, column 3 - line 205, column 61): " + [ maybeToken.constructor.name ]);
        });
    };
};
var createTournament = function (params) {
    return bind(liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
        if (maybeToken instanceof Data_Maybe.Nothing) {
            return pure(new Data_Either.Left("Not authenticated"));
        };
        if (maybeToken instanceof Data_Maybe.Just) {
            var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0), new Affjax_RequestHeader.RequestHeader("Content-Type", "application/json") ];
            var body = extend(assoc1("name")(params.name))(extend(assoc1("city")(params.city))(extend(assoc("year")(params.year))(extend(assoc1("lexicon")(params.lexicon))(extend(assoc1("longFormName")(params.longFormName))(extend(assoc1("dataUrl")(params.dataUrl))(extend(assoc1("theme")(params.theme))(encodeJson({}))))))));
            return bind(Affjax_Web.request({
                username: Affjax.defaultRequest.username,
                password: Affjax.defaultRequest.password,
                withCredentials: Affjax.defaultRequest.withCredentials,
                timeout: Affjax.defaultRequest.timeout,
                url: "http://localhost:3001/api/private/tournaments",
                method: new Data_Either.Left(Data_HTTP_Method.POST.value),
                headers: headers,
                content: new Data_Maybe.Just(Affjax_RequestBody.json(body)),
                responseFormat: Affjax_ResponseFormat.json
            }))(function (result) {
                if (result instanceof Data_Either.Left) {
                    return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
                };
                if (result instanceof Data_Either.Right) {
                    return pure(decodeTournamentRowResponse(result.value0.body));
                };
                throw new Error("Failed pattern match at API.Tournament (line 92, column 7 - line 94, column 75): " + [ result.constructor.name ]);
            });
        };
        throw new Error("Failed pattern match at API.Tournament (line 69, column 3 - line 94, column 75): " + [ maybeToken.constructor.name ]);
    });
};
var clearCache = /* #__PURE__ */ bind(/* #__PURE__ */ liftEffect(Utils_Auth.getAuthToken))(function (maybeToken) {
    if (maybeToken instanceof Data_Maybe.Nothing) {
        return pure(new Data_Either.Left("Not authenticated"));
    };
    if (maybeToken instanceof Data_Maybe.Just) {
        var headers = [ new Affjax_RequestHeader.RequestHeader("Authorization", "Bearer " + maybeToken.value0) ];
        return bind(Affjax_Web.request({
            content: Affjax.defaultRequest.content,
            username: Affjax.defaultRequest.username,
            password: Affjax.defaultRequest.password,
            withCredentials: Affjax.defaultRequest.withCredentials,
            timeout: Affjax.defaultRequest.timeout,
            url: "http://localhost:3001/api/private/cache/clear",
            method: new Data_Either.Left(Data_HTTP_Method.POST.value),
            headers: headers,
            responseFormat: Affjax_ResponseFormat.json
        }))(function (result) {
            if (result instanceof Data_Either.Left) {
                return pure(new Data_Either.Left("Network error: " + Affjax.printError(result.value0)));
            };
            if (result instanceof Data_Either.Right) {
                return bind(pure(decodeJson(result.value0.body)))(function (obj) {
                    if (obj instanceof Data_Either.Left) {
                        return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(obj.value0)));
                    };
                    if (obj instanceof Data_Either.Right) {
                        return bind(pure(getField(obj.value0)("success")))(function (success) {
                            if (success instanceof Data_Either.Left) {
                                return pure(new Data_Either.Left(Data_Argonaut_Decode_Error.printJsonDecodeError(success.value0)));
                            };
                            if (success instanceof Data_Either.Right && !success.value0) {
                                return bind(pure(getField1(obj.value0)("error")))(function (error) {
                                    if (error instanceof Data_Either.Left) {
                                        return pure(new Data_Either.Left("Failed to clear cache"));
                                    };
                                    if (error instanceof Data_Either.Right) {
                                        return pure(new Data_Either.Left(error.value0));
                                    };
                                    throw new Error("Failed pattern match at API.Tournament (line 313, column 19 - line 315, column 55): " + [ error.constructor.name ]);
                                });
                            };
                            if (success instanceof Data_Either.Right && success.value0) {
                                return pure(new Data_Either.Right(Data_Unit.unit));
                            };
                            throw new Error("Failed pattern match at API.Tournament (line 309, column 15 - line 316, column 48): " + [ success.constructor.name ]);
                        });
                    };
                    throw new Error("Failed pattern match at API.Tournament (line 305, column 11 - line 316, column 48): " + [ obj.constructor.name ]);
                });
            };
            throw new Error("Failed pattern match at API.Tournament (line 301, column 7 - line 316, column 48): " + [ result.constructor.name ]);
        });
    };
    throw new Error("Failed pattern match at API.Tournament (line 289, column 3 - line 316, column 48): " + [ maybeToken.constructor.name ]);
});
export {
    decodeTournament,
    decodeTournamentListResponse,
    createTournament,
    listTournaments,
    decodeTournamentRowResponse,
    getTournamentRow,
    updateTournament,
    enablePolling,
    stopPolling,
    clearCache,
    refetchTournament,
    fullRefetchTournament
};
